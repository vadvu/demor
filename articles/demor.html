<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started with `demor` • demor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started with `demor`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">demor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/demor.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get started with `demor`</h1>
            
      

      <div class="d-none name"><code>demor.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>demor</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vadvu/demor"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-rosbris-data">Get Rosbris data<a class="anchor" aria-label="anchor" href="#get-rosbris-data"></a>
</h2>
<p>The data from <span class="citation"><span>“<span class="nocase">The
Russian Fertility and Mortality database</span>”</span> (<a href="#ref-rosbris">2024</a>)</span> is presented in the
<code>demor</code> as datasets in the long-format (mortality/fertility
by 1/5-year age groups from 1989 to 2022).<br></p>
<p>The example of usage is placed below, where data on mortality by
5-year age groups is presented:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_mortality_pop_5.html">rosbris_mortality_pop_5</a></span></span>
<span></span>
<span><span class="co"># for 1-year age interval</span></span>
<span><span class="co"># dbm &lt;- demor::rosbris_mortality_pop_1</span></span></code></pre></div>
<p>Lets see the data for Russia in 2010 for males and for total
population (both urban and rural)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;       year code territory sex age       mx       N        Dx</span></span>
<span><span class="co">#&gt; 20445 2010 1100         t   m   0 0.008823  869388   7670.61</span></span>
<span><span class="co">#&gt; 20446 2010 1100         t   m   1 0.000604 3222450   1946.36</span></span>
<span><span class="co">#&gt; 20447 2010 1100         t   m   5 0.000355 3613276   1282.71</span></span>
<span><span class="co">#&gt; 20448 2010 1100         t   m  10 0.000387 3398894   1315.37</span></span>
<span><span class="co">#&gt; 20449 2010 1100         t   m  15 0.001186 4353344   5163.07</span></span>
<span><span class="co">#&gt; 20450 2010 1100         t   m  20 0.002546 6193325  15768.21</span></span>
<span><span class="co">#&gt; 20451 2010 1100         t   m  25 0.004491 6002262  26956.16</span></span>
<span><span class="co">#&gt; 20452 2010 1100         t   m  30 0.006808 5395865  36735.05</span></span>
<span><span class="co">#&gt; 20453 2010 1100         t   m  35 0.007934 4973298  39458.15</span></span>
<span><span class="co">#&gt; 20454 2010 1100         t   m  40 0.009782 4464789  43674.57</span></span>
<span><span class="co">#&gt; 20455 2010 1100         t   m  45 0.013354 5140274  68643.22</span></span>
<span><span class="co">#&gt; 20456 2010 1100         t   m  50 0.018567 5207919  96695.43</span></span>
<span><span class="co">#&gt; 20457 2010 1100         t   m  55 0.026250 4333619 113757.50</span></span>
<span><span class="co">#&gt; 20458 2010 1100         t   m  60 0.037143 3117320 115786.62</span></span>
<span><span class="co">#&gt; 20459 2010 1100         t   m  65 0.049925 1573662  78565.08</span></span>
<span><span class="co">#&gt; 20460 2010 1100         t   m  70 0.068599 2149929 147482.98</span></span>
<span><span class="co">#&gt; 20461 2010 1100         t   m  75 0.097635 1077916 105242.33</span></span>
<span><span class="co">#&gt; 20462 2010 1100         t   m  80 0.138043  714191  98589.07</span></span>
<span><span class="co">#&gt; 20463 2010 1100         t   m  85 0.198593  231350  45944.49</span></span>
<span><span class="co">#&gt;                       name</span></span>
<span><span class="co">#&gt; 20445 Российская Федерация</span></span>
<span><span class="co">#&gt; 20446 Российская Федерация</span></span>
<span><span class="co">#&gt; 20447 Российская Федерация</span></span>
<span><span class="co">#&gt; 20448 Российская Федерация</span></span>
<span><span class="co">#&gt; 20449 Российская Федерация</span></span>
<span><span class="co">#&gt; 20450 Российская Федерация</span></span>
<span><span class="co">#&gt; 20451 Российская Федерация</span></span>
<span><span class="co">#&gt; 20452 Российская Федерация</span></span>
<span><span class="co">#&gt; 20453 Российская Федерация</span></span>
<span><span class="co">#&gt; 20454 Российская Федерация</span></span>
<span><span class="co">#&gt; 20455 Российская Федерация</span></span>
<span><span class="co">#&gt; 20456 Российская Федерация</span></span>
<span><span class="co">#&gt; 20457 Российская Федерация</span></span>
<span><span class="co">#&gt; 20458 Российская Федерация</span></span>
<span><span class="co">#&gt; 20459 Российская Федерация</span></span>
<span><span class="co">#&gt; 20460 Российская Федерация</span></span>
<span><span class="co">#&gt; 20461 Российская Федерация</span></span>
<span><span class="co">#&gt; 20462 Российская Федерация</span></span>
<span><span class="co">#&gt; 20463 Российская Федерация</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h2>
<div class="section level3">
<h3 id="life-table">Life table<a class="anchor" aria-label="anchor" href="#life-table"></a>
</h3>
<p>Now one can create <em>life table</em> based on gotten data for
2010-Russia using <code><a href="../reference/LT.html">LT()</a></code>.<br>
Note,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>x</mi></msub><annotation encoding="application/x-tex">a_x</annotation></semantics></math>
for age 0 is modeled as in <span class="citation">Evgeny M. Andreev and
Kingkade (<a href="#ref-Andreev_ax">2015</a>)</span>, while the function
can use user-specific
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>x</mi></msub><annotation encoding="application/x-tex">a_x</annotation></semantics></math>
from the argument <code>ax</code>. However, despite there is a plethora
of methods to construct life table that “are based upon very different
assumptions, when applied to actual mortality rates they do not result
in significant differences of importance to mortality analysis.” <span class="citation">(WHO, 1977, p. 70, cite from <a href="#ref-preston">Preston, Heuveline, and Guillot 2001,
47</a>)</span>. For example, changing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mn>0</mn></msub><annotation encoding="application/x-tex">a_0</annotation></semantics></math>
to 0.5 only increases the life expectancy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mn>0</mn></msub><annotation encoding="application/x-tex">e_0</annotation></semantics></math>
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≈</mo><mo>+</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">\approx +0.01</annotation></semantics></math>
for the 2010 Russian male population, which is about 4 days when applied
to human life span.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/LT.html">LT</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>, </span>
<span>  sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>  mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span> <span class="co">#age specific mortality rates (mx)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt;       age      mx    ax      qx      lx      dx      Lx       Tx    ex</span></span>
<span><span class="co">#&gt;  [1,]   0 0.00882 0.132 0.00876 1.00000 0.00876 0.99885 63.04122 63.04</span></span>
<span><span class="co">#&gt;  [2,]   1 0.00060 2.000 0.00241 0.99124 0.00239 3.96019 62.04238 62.59</span></span>
<span><span class="co">#&gt;  [3,]   5 0.00036 2.500 0.00177 0.98885 0.00175 4.93988 58.08218 58.74</span></span>
<span><span class="co">#&gt;  [4,]  10 0.00039 2.500 0.00193 0.98710 0.00191 4.93072 53.14231 53.84</span></span>
<span><span class="co">#&gt;  [5,]  15 0.00119 2.500 0.00591 0.98519 0.00582 4.91139 48.21159 48.94</span></span>
<span><span class="co">#&gt;  [6,]  20 0.00255 2.500 0.01265 0.97937 0.01239 4.86586 43.30020 44.21</span></span>
<span><span class="co">#&gt;  [7,]  25 0.00449 2.500 0.02221 0.96698 0.02147 4.78120 38.43434 39.75</span></span>
<span><span class="co">#&gt;  [8,]  30 0.00681 2.500 0.03347 0.94550 0.03165 4.64841 33.65314 35.59</span></span>
<span><span class="co">#&gt;  [9,]  35 0.00793 2.500 0.03890 0.91386 0.03555 4.48042 29.00473 31.74</span></span>
<span><span class="co">#&gt; [10,]  40 0.00978 2.500 0.04774 0.87831 0.04193 4.28672 24.52431 27.92</span></span>
<span><span class="co">#&gt; [11,]  45 0.01335 2.500 0.06461 0.83638 0.05404 4.04679 20.23759 24.20</span></span>
<span><span class="co">#&gt; [12,]  50 0.01857 2.500 0.08872 0.78234 0.06941 3.73817 16.19080 20.70</span></span>
<span><span class="co">#&gt; [13,]  55 0.02625 2.500 0.12317 0.71293 0.08781 3.34513 12.45263 17.47</span></span>
<span><span class="co">#&gt; [14,]  60 0.03714 2.500 0.16994 0.62512 0.10623 2.86003  9.10751 14.57</span></span>
<span><span class="co">#&gt; [15,]  65 0.04992 2.500 0.22193 0.51889 0.11516 2.30657  6.24748 12.04</span></span>
<span><span class="co">#&gt; [16,]  70 0.06860 2.500 0.29278 0.40374 0.11821 1.72316  3.94091  9.76</span></span>
<span><span class="co">#&gt; [17,]  75 0.09764 2.500 0.39240 0.28553 0.11204 1.14754  2.21775  7.77</span></span>
<span><span class="co">#&gt; [18,]  80 0.13804 2.500 0.51313 0.17349 0.08902 0.64489  1.07021  6.17</span></span>
<span><span class="co">#&gt; [19,]  85 0.19859 5.035 1.00000 0.08447 0.08447 0.42532  0.42532  5.04</span></span></code></pre></div>
<p>Note, from life table one can compute other <em>functions</em> (not
just
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>x</mi></msub><annotation encoding="application/x-tex">e_x</annotation></semantics></math>)
and quantities of interest:</p>
<ol style="list-style-type: decimal">
<li>Crude death rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>D</mi><mi>R</mi><mo>=</mo><mn>1</mn><mi>/</mi><msub><mi>e</mi><mn>0</mn></msub><mo>=</mo><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>D</mi><mi>x</mi></msub><mi>/</mi><msub><mo>∑</mo><mi>x</mi></msub><msub><mi>N</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">CDR = 1/e_0 = \sum_x D_x / \sum_x N_x</annotation></semantics></math>
or death rate above some age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>:</mo><mn>1</mn><mi>/</mi><msub><mi>e</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">x: 1/e_x</annotation></semantics></math>
</li>
<li>Probability of surviving from age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
to age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>l</mi><mi>y</mi></msub><mi>/</mi><msub><mi>l</mi><mi>x</mi></msub><mo>≈</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>m</mi><mi>x</mi></msub><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x,y)=l_y/l_x \approx exp(-m_x \times n)</annotation></semantics></math>
</li>
<li>Probability that a newborn will die between ages
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">x+n</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mi>x</mi><mi>n</mi></msubsup><mi>/</mi><msub><mi>l</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">d_x^n/l_0</annotation></semantics></math>
</li>
<li>Probability that a newborn will die between ages
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>l</mi><mi>x</mi></msub><mo>−</mo><msub><mi>l</mi><mi>y</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>l</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">(l_x-l_y)/l_0</annotation></semantics></math>
</li>
<li>Probability that a newborn will survive to age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>l</mi><mi>x</mi></msub><mi>/</mi><msub><mi>l</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">p(x) = l_x/l_0</annotation></semantics></math>
</li>
<li>Probability that a newborn will die in age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>p</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">q(x) = 1-p_x</annotation></semantics></math>
</li>
<li>Life course ratio from age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
that is the fraction of person-years lived from age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
onward:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>y</mi></msub><mi>/</mi><msub><mi>T</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">T_y/T_x</annotation></semantics></math>
</li>
<li>Crude estimate of the number of births needed to “replace” expected
deaths:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>/</mi><msub><mi>e</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P/e_0</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>
is total population</li>
</ol>
<p>See also <span class="citation">Preston, Heuveline, and Guillot (<a href="#ref-preston">2001</a>)</span>.</p>
<p>The life table is the one of the most important demographic tools
that can be used not only for mortality, but for any other decrement
processes (for ex., marital, occupation, migration status and etc).</p>
</div>
<div class="section level3">
<h3 id="human-life-indicator-hli">Human Life Indicator (HLI)<a class="anchor" aria-label="anchor" href="#human-life-indicator-hli"></a>
</h3>
<p>A good alternative to the <em>human development indicator</em> (HDI)
is the <em>human life indicator</em> (HLI) proposed by <span class="citation">Ghislandi, Sanderson, and Scherbov (<a href="#ref-hli">2019</a>)</span>. It requires just
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>
(and it is based on <em>life table</em>). It is calculated as geometric
mean of lifespans:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>L</mi><mi>I</mi><mo>=</mo><munderover><mo>∏</mo><mi>x</mi><mi>ω</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>+</mo><msub><mi>a</mi><mi>x</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>d</mi><mi>x</mi></msub></msup></mrow><annotation encoding="application/x-tex">HLI = \prod_x^\omega{(x+a_x)^{d_x}}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
is age and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>x</mi></msub><annotation encoding="application/x-tex">a_x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>x</mi></msub><annotation encoding="application/x-tex">d_x</annotation></semantics></math>
are functions from <em>life table</em> that corresponds to age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>.</p>
<p>Calculation in the <code>demor</code> is as follows (one need only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/hli.html">hli</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>, </span>
<span>  mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span>,</span>
<span>  sex <span class="op">=</span> <span class="st">"m"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 57.18468</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gini-coefficient">Gini coefficient<a class="anchor" aria-label="anchor" href="#gini-coefficient"></a>
</h3>
<p>As <span class="citation">Shkolnikov, Andreev, and Begun (<a href="#ref-Shkolnikov_gini">2003</a>)</span> note, “at present, the
average level of life expectancy is high in many countries and it is
interesting to study to what extent this advantage is equally accessible
to all people”. (p. 306). One of the tools for analysing mortality
inequality within the population (or, rather, the life table) is the
Gini index, which is similar to the “usual” index widely used in
economics. Life table Gini,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>,
shows a degree of inter-individual variability in age at death and can
be interpreted as in other fields
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>0</mn></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">G_0 \in [0,1]</annotation></semantics></math>;
higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>G</mi><mn>0</mn></msub><annotation encoding="application/x-tex">G_0</annotation></semantics></math>,
higher inequality and vice versa). Also one can be interested in
“absolute” Gini coefficient (aka AID - Absolute Inter-individual
Difference) that is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>G</mi><mn>0</mn><mrow><mi>a</mi><mi>b</mi><mi>s</mi></mrow></msubsup><mo>=</mo><msub><mi>G</mi><mn>0</mn></msub><mo>×</mo><msub><mi>e</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">G_0^{abs} = G_0 \times e_0</annotation></semantics></math>
which “is equal to the average inter-individual difference in length of
life and is measured in years.” <span class="citation">(<a href="#ref-Shkolnikov_gini">Shkolnikov, Andreev, and Begun 2003,
312</a>)</span></p>
<p>Below is the function <code>gini</code> that computes Gini index as
well as produces data for Lorenz curve - the graphical representation of
inequality. The formulas for the calculations are derived from <span class="citation">Shkolnikov, Andreev, and Begun (<a href="#ref-Shkolnikov_gini">2003</a>)</span> (that is based on the <span class="citation">Hanada (<a href="#ref-hanada_gini">1983</a>)</span>
formulation).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm.1</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_mortality_pop_1.html">rosbris_mortality_pop_1</a></span></span>
<span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1995</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/gini.html">gini</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, mx <span class="op">=</span> <span class="va">mx</span>, sex <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">Gini</span></span>
<span><span class="co">#&gt; $G0</span></span>
<span><span class="co">#&gt;        ex </span></span>
<span><span class="co">#&gt; 0.1295455 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $G0_abs</span></span>
<span><span class="co">#&gt;      ex </span></span>
<span><span class="co">#&gt; 9.27805</span></span></code></pre></div>
<p>Note, in <span class="citation">Shkolnikov, Andreev, and Begun (<a href="#ref-Shkolnikov_gini">2003</a>)</span> the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mn>0.13</mn></mrow><annotation encoding="application/x-tex">G_0 = 0.13</annotation></semantics></math>
(see p. 310, figure 1), while using <code>gini</code> one obtains
0.1295. Also note that the larger the age interval, the less accurate
the estimate will be, since it is based on a discrete approximation of a
continuous function.</p>
<p>Below is an example of Lorenz curve that can be created using ggplot2
and <code>gini</code> output.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">plot</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">Fx</span>, <span class="va">Phix</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Proportion in population"</span>, y <span class="op">=</span> <span class="st">"Proportion in person-years of life"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Lorenz curve: Russia, 1995, females"</span>, </span>
<span>          subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"G0 = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">Gini</span><span class="op">$</span><span class="va">G0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, </span>
<span>                            <span class="st">"G0 abs = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">Gini</span><span class="op">$</span><span class="va">G0_abs</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>,</span>
<span>                            <span class="st">"e0 = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">Gini</span><span class="op">$</span><span class="va">G0_abs</span><span class="op">/</span><span class="va">res</span><span class="op">$</span><span class="va">Gini</span><span class="op">$</span><span class="va">G0</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>Note, one can calculate not only Gini <em>inequality</em> index, but
also Drewnowski’s index of <em>equality</em> that is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>G</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">D_0 = 1 - G_0</annotation></semantics></math>
proposed by <span class="citation">Aburto et al. (<a href="#ref-Drewnowski">2022</a>)</span> (so, for Russian 1995 females it
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mn>0.13</mn><mo>=</mo><mn>0.87</mn></mrow><annotation encoding="application/x-tex">1-0.13=0.87</annotation></semantics></math>)
that also can serve as an indicator of the shape of mortality
patterns.</p>
</div>
<div class="section level3">
<h3 id="e-dagger">e-dagger<a class="anchor" aria-label="anchor" href="#e-dagger"></a>
</h3>
<p>Another measure of mortality inequality is “e-dagger”,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>e</mi><mi>x</mi><mo>†</mo></msubsup><annotation encoding="application/x-tex">e^{\dagger}_x</annotation></semantics></math>,
proposed by <span class="citation">Vaupel and Romo (<a href="#ref-edagger">2003</a>)</span>, that is approximation of “the
average life expectancy lost because of death” <span class="citation">(<a href="#ref-edagger">Vaupel and Romo 2003,
206</a>)</span>.</p>
<p>In <code>demor</code> there is a function <code>edagger</code> for
calculation “e-dagger” for age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>e</mi><mi>x</mi><mo>†</mo></msubsup><annotation encoding="application/x-tex">e^{\dagger}_x</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1995</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/edagger.html">edagger</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, mx <span class="op">=</span> <span class="va">mx</span>, sex <span class="op">=</span> <span class="st">"f"</span><span class="op">)</span></span>
<span><span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">26</span>, <span class="fl">51</span>, <span class="fl">76</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;         0        25        50        75 </span></span>
<span><span class="co">#&gt; 12.719536 10.968361  9.137110  5.201578</span></span></code></pre></div>
<p>Hence,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>e</mi><mn>0</mn><mo>†</mo></msubsup><annotation encoding="application/x-tex">e_0^{\dagger}</annotation></semantics></math>
for Russian female population in 1995 is 12.72. From
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>e</mi><mi>x</mi><mo>†</mo></msubsup><annotation encoding="application/x-tex">e^{\dagger}_x</annotation></semantics></math>
one can also calculate life table entropy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>x</mi></msub><annotation encoding="application/x-tex">H_x</annotation></semantics></math><span class="citation">(see, for ex., <a href="#ref-comp_ineq2">Wrycza,
Missov, and Baudisch 2015</a>)</span> that is simply
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>x</mi></msub><mo>=</mo><msubsup><mi>e</mi><mi>x</mi><mo>†</mo></msubsup><mi>/</mi><msub><mi>e</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">H_x = e^{\dagger}_x/e_x</annotation></semantics></math>.
Usually only one quantity as entropy is presented that is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>,
which sometimes is denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>H</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar H</annotation></semantics></math>,
and it is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>e</mi><mn>0</mn><mo>†</mo></msubsup><mi>/</mi><msub><mi>e</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">e^{\dagger}_0/e_0</annotation></semantics></math>.</p>
<p>Note that the larger the age interval, the less accurate the estimate
will be, since it is based on a discrete approximation of a continuous
function.</p>
<p>For more inequality indicators and their comparisons, see <span class="citation">Shkolnikov, Andreev, and Begun (<a href="#ref-Shkolnikov_gini">2003</a>)</span>, <span class="citation">Wrycza, Missov, and Baudisch (<a href="#ref-comp_ineq2">2015</a>)</span> and <span class="citation">Wilmoth and Horiuchi (<a href="#ref-comp_ineq1">1999</a>)</span> as well as <a href="https://github.com/alysonvanraalte/LifeIneq" class="external-link"><code>LifeIneq</code></a>
package.</p>
</div>
<div class="section level3">
<h3 id="years-of-life-lost-yll">Years of Life Lost (YLL)<a class="anchor" aria-label="anchor" href="#years-of-life-lost-yll"></a>
</h3>
<p>One of the most popular (and relatively young) measure of
<em>lifespan inequality</em> is “<em>years of life lost</em>” (YLL)
proposed in <span class="citation">Martinez et al. (<a href="#ref-yll">2019</a>)</span>. As authors claim, “YLL is a valuable
measure for public health surveillance, particularly for quantifying the
level and trends of premature mortality, identification of leading
causes of premature deaths and monitoring the progress of YLL as a key
indicator of population health” <span class="citation">(<a href="#ref-yll">Martinez et al. 2019, 1368</a>)</span>.</p>
<p>Authors proposed different metrics of <em>YLL</em>:</p>
<ol style="list-style-type: decimal">
<li>Absolute number of <em>YLL</em>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>L</mi><msub><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>=</mo><msub><mi>D</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>*</mo><mi>S</mi><mi>L</mi><msub><mi>E</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">YLL_{x,t,c}=D_{x,t,c}*SLE_x</annotation></semantics></math>
that is calculated for age <em>x</em>, time <em>t</em> and cause of
death <em>c</em>. <em>YLL</em> for the whole population is just sum of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>L</mi><msub><mi>L</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">YLL_x</annotation></semantics></math>.
<em>SLE</em> is the <em>standard life expectancy</em> that is invariant
over time, sex and population (it’s meaning is straightforward: it is
the potential maximum life span of an individual, who is not exposed to
avoidable health risks or severe injuries and receives appropriate
health services), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>x</mi></msub><annotation encoding="application/x-tex">D_x</annotation></semantics></math>
is a number of deaths at age <em>x</em>. Of course, one can calculate
<em>YLL</em> not for specific cause <em>c</em>, but for overall
mortality that is called <em>all-causes YLL</em>.</li>
<li>
<em>YLL</em> as proportion:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>L</mi><msubsup><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow><mi>p</mi></msubsup><mo>=</mo><mi>Y</mi><mi>L</mi><msub><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow></msub><mi>/</mi><mi>Y</mi><mi>L</mi><msub><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">YLL^p_{x,t,c}=YLL_{x,t,c}/YLL_{x,t}</annotation></semantics></math>
that is just <em>cause specific YLL</em> divided by <em>all-causes
YLL</em>.</li>
<li>
<em>YLL</em> rate:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>L</mi><msubsup><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow><mi>r</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mi>L</mi><msub><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow></msub><mi>/</mi><msub><mi>P</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>*</mo><mn>100</mn><mi>′</mi><mn>000</mn></mrow><annotation encoding="application/x-tex">YLL^r_{x,t,c}=[YLL_{x,t,c}/P_{x,t}] * 100'000</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">P_{x,t}</annotation></semantics></math>
is population.</li>
<li>Age-standardized <em>YLL</em> rate:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>S</mi><mi>Y</mi><msub><mi>R</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mi>x</mi><mi>ω</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mi>L</mi><msubsup><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow><mi>r</mi></msubsup><mo>*</mo><msub><mi>W</mi><mi>x</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">ASYR_{x,t,c} = \sum_x^\omega{[YLL^r_{x,t,c}*W_x]}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>x</mi></msub><annotation encoding="application/x-tex">W_x</annotation></semantics></math>
is the standard population weight at age <em>x</em>, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>
is the oldest, closing age (for ex., 85+ or 100+). In other words, it’s
just direct standardization of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mi>L</mi><msubsup><mi>L</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi><mo>,</mo><mi>c</mi></mrow><mi>r</mi></msubsup></mrow><annotation encoding="application/x-tex">YLL^r_{x,t,c}</annotation></semantics></math>.</li>
</ol>
<p>Let’s calculate all-cause <em>YLL</em>, <em>Yll rate</em> and
<em>ASYR</em> using Rosbris data that we have downloaded.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#YLL</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"yll"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $yll_all</span></span>
<span><span class="co">#&gt; [1] 33640561</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $yll</span></span>
<span><span class="co">#&gt;  [1]  705159.2  174024.0  108414.6  104611.4  384855.2 1096994.4 1741367.9</span></span>
<span><span class="co">#&gt;  [8] 2190511.0 2157177.1 2171936.4 3075902.7 3860081.6 3989475.5 3502545.3</span></span>
<span><span class="co">#&gt; [15] 2002623.9 3063221.5 1729131.5 1233349.3  349178.1</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#YLL rate</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"yll.r"</span>, pop <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="co">#&gt; $yll.r_all</span></span>
<span><span class="co">#&gt; [1] 50945.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $yll.r</span></span>
<span><span class="co">#&gt;  [1]  81109.836   5400.365   3000.453   3077.806   8840.451  17712.527</span></span>
<span><span class="co">#&gt;  [7]  29011.861  40596.105  43375.182  48645.890  59839.275  74119.462</span></span>
<span><span class="co">#&gt; [13]  92058.751 112357.578 127258.833 142480.124 160414.307 172691.796</span></span>
<span><span class="co">#&gt; [19] 150930.678</span></span></code></pre></div>
<p>For <em>ASYR</em> one needs standard population. Let’s use 2010
population as standard (note, in this case <em>ASYR</em> equals <em>YLL
rate</em> because we use 2010 mortality).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#ASYR</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"asyr"</span>, pop <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span>, w <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $asyr_all</span></span>
<span><span class="co">#&gt; [1] 50945.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $asyr</span></span>
<span><span class="co">#&gt;  [1] 1067.8879  263.5407  164.1824  158.4227  582.8220 1661.2803 2637.1149</span></span>
<span><span class="co">#&gt;  [8] 3317.2939 3266.8132 3289.1646 4658.1245 5845.6793 6041.6326 5304.2289</span></span>
<span><span class="co">#&gt; [15] 3032.7590 4638.9202 2618.5841 1867.7751  528.7928</span></span></code></pre></div>
<p>Also one can calculate different <em>YLL</em> measures using
standards that are provided by <code>demor</code> as dataframe.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/sle_stand.html">sle_stand</a></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="age-decomposition-of-differences-in-life-expectancies">Age decomposition of differences in life expectancies<a class="anchor" aria-label="anchor" href="#age-decomposition-of-differences-in-life-expectancies"></a>
</h3>
<p>Also one can do simple <em>decomposition</em> between 2 populations.
Lets use Russia-2000 as <em>base population</em> and Russia-2010 as
<em>compared population</em>. This function implements three almost
identical discrete methods that were proposed almost simultaneously: in
<span class="citation">Андреев (<a href="#ref-andreev_dec">1982</a>)</span>, in <span class="citation">Arriaga (<a href="#ref-arriaga_dec">1984</a>)</span>
and in <span class="citation">Pollard (<a href="#ref-pollard_dec">1982</a>)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="va">rus2000</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2000</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decomp.html">decomp</a></span><span class="op">(</span>mx1 <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">mx</span>, </span>
<span>              mx2 <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span>, </span>
<span>              age <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">age</span>, </span>
<span>              method <span class="op">=</span> <span class="st">"andreev"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dec</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age   ex1   ex2     lx2  dex ex12  ex12_prc</span></span>
<span><span class="co">#&gt; 1   0 58.99 63.04 1.00000 4.05 0.54 13.235294</span></span>
<span><span class="co">#&gt; 2   1 59.04 62.59 0.99124 3.55 0.11  2.696078</span></span>
<span><span class="co">#&gt; 3   5 55.29 58.74 0.98885 3.45 0.07  1.715686</span></span>
<span><span class="co">#&gt; 4  10 50.45 53.84 0.98710 3.39 0.05  1.225490</span></span>
<span><span class="co">#&gt; 5  15 45.59 48.94 0.98519 3.35 0.22  5.392157</span></span>
<span><span class="co">#&gt; 6  20 41.05 44.21 0.97937 3.16 0.46 11.274510</span></span></code></pre></div>
<p>Than let us plot the result of <code>decomp</code> using
<code>ggplot2</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dec</span>, <span class="fu">aes</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="va">ex12</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"orange3"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age-groups"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Сontribution to the e0 difference"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="st">"70"</span>, y <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Total difference in e0: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dec</span><span class="op">$</span><span class="va">ex12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">ex12</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1.5</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="age-and-cause-decomposition-of-differences-in-life-expectancies">Age and cause decomposition of differences in life expectancies<a class="anchor" aria-label="anchor" href="#age-and-cause-decomposition-of-differences-in-life-expectancies"></a>
</h3>
<p>Also one can do <em>decomposition</em> between 2 populations by
<em>age</em> and <em>causes</em>. Lets use example from <span class="citation">E. M. Andreev and Shkolnikov (<a href="#ref-and_sch_mdecomp">2012</a>)</span> where data for US and
England and Wales men mortality by some causes are presented.</p>
<p>Lets see the data</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mdecompex"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mdecompex</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;     age neoplasms circulatory respiratory  digestive  accident     other     all</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0 0.000<span style="text-decoration: underline;">034</span>9  0.000<span style="text-decoration: underline;">173</span>    0.000<span style="text-decoration: underline;">188</span>   0.000<span style="text-decoration: underline;">151</span>   0.000<span style="text-decoration: underline;">377</span>  0.006<span style="text-decoration: underline;">69</span>   7.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 0.000<span style="text-decoration: underline;">030</span>9  0.000<span style="text-decoration: underline;">015</span>5   0.000<span style="text-decoration: underline;">022</span>0  0.000<span style="text-decoration: underline;">009</span>30 0.000<span style="text-decoration: underline;">163</span>  0.000<span style="text-decoration: underline;">112</span>  3.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     5 0.000<span style="text-decoration: underline;">031</span>3  0.000<span style="text-decoration: underline;">005</span>60  0.000<span style="text-decoration: underline;">006</span>87 0.000<span style="text-decoration: underline;">003</span>24 0.000<span style="text-decoration: underline;">079</span>2 0.000<span style="text-decoration: underline;">040</span>9 1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    10 0.000<span style="text-decoration: underline;">030</span>5  0.000<span style="text-decoration: underline;">012</span>7   0.000<span style="text-decoration: underline;">008</span>96 0.000<span style="text-decoration: underline;">002</span>86 0.000<span style="text-decoration: underline;">127</span>  0.000<span style="text-decoration: underline;">049</span>0 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    15 0.000<span style="text-decoration: underline;">042</span>4  0.000<span style="text-decoration: underline;">032</span>2   0.000<span style="text-decoration: underline;">014</span>1  0.000<span style="text-decoration: underline;">004</span>01 0.000<span style="text-decoration: underline;">765</span>  0.000<span style="text-decoration: underline;">082</span>1 9.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    20 0.000<span style="text-decoration: underline;">060</span>0  0.000<span style="text-decoration: underline;">051</span>1   0.000<span style="text-decoration: underline;">015</span>8  0.000<span style="text-decoration: underline;">009</span>28 0.001<span style="text-decoration: underline;">14</span>   0.000<span style="text-decoration: underline;">130</span>  1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: cnt &lt;chr&gt;</span></span></span></code></pre></div>
<p>For <code>mdecomp</code> 2 lists with arrays for 2 population are
required.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#US men</span></span>
<span><span class="va">mx1</span> <span class="op">&lt;-</span> <span class="va">mdecompex</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cnt</span> <span class="op">==</span> <span class="st">"usa"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cnt</span>, <span class="op">-</span><span class="va">age</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">all</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#England and Wales men</span></span>
<span><span class="va">mx2</span> <span class="op">&lt;-</span> <span class="va">mdecompex</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cnt</span> <span class="op">==</span> <span class="st">"eng"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">cnt</span>, <span class="op">-</span><span class="va">age</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="va">all</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">decm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdecomp.html">mdecomp</a></span><span class="op">(</span>mx1 <span class="op">=</span> <span class="va">mx1</span>, </span>
<span>              mx2 <span class="op">=</span> <span class="va">mx2</span>, </span>
<span>              sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>              age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>              method <span class="op">=</span> <span class="st">"andreev"</span></span>
<span>              <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age ex12     neoplasms  circulatory   respiratory     digestive   accident</span></span>
<span><span class="co">#&gt; 1   0 0.13  0.0009474709 7.090137e-03  0.0042212672  7.167768e-03 0.02282901</span></span>
<span><span class="co">#&gt; 2   1 0.03 -0.0025030458 5.483996e-04  0.0020247182  6.245908e-04 0.03637029</span></span>
<span><span class="co">#&gt; 3   5 0.02 -0.0016468368 8.262058e-05 -0.0001300012  9.929857e-05 0.02178479</span></span>
<span><span class="co">#&gt; 4  10 0.01 -0.0014084238 4.993427e-04 -0.0002451017  8.338450e-05 0.01117647</span></span>
<span><span class="co">#&gt; 5  15 0.13 -0.0032690840 2.657675e-03  0.0005053688 -2.052103e-04 0.13796276</span></span>
<span><span class="co">#&gt; 6  20 0.17 -0.0009648903 2.773336e-03 -0.0016773417 -8.983808e-04 0.18353643</span></span>
<span><span class="co">#&gt;           other</span></span>
<span><span class="co">#&gt; 1  0.0877443429</span></span>
<span><span class="co">#&gt; 2 -0.0070649563</span></span>
<span><span class="co">#&gt; 3 -0.0001898743</span></span>
<span><span class="co">#&gt; 4 -0.0001056675</span></span>
<span><span class="co">#&gt; 5 -0.0076515085</span></span>
<span><span class="co">#&gt; 6 -0.0127691565</span></span></code></pre></div>
<p>Than let us plot the result of <code>mdecomp</code> using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a>. This requires
some data transformations</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">decm_plot</span> <span class="op">&lt;-</span> <span class="va">decm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"ex12"</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">decm_plot_i</span> <span class="op">&lt;-</span> <span class="va">decm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">decm_plot_i</span><span class="op">$</span><span class="va">group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm_plot_i</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"ex12"</span></span>
<span>  <span class="va">decm_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">decm_plot</span>,<span class="va">decm_plot_i</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">decm_plot_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">decm_plot</span><span class="op">[</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">[</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">ex12</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">decm_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">ex12</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Contribution to difference in ex"</span>, fill <span class="op">=</span> <span class="st">"Cause (contribution):"</span>, </span>
<span>       caption  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Total difference in ex = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">decm</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="multiple-decrement-life-table">Multiple Decrement Life Table<a class="anchor" aria-label="anchor" href="#multiple-decrement-life-table"></a>
</h3>
<p>Also one can construct the Multiple Decrement Life Table that expands
the usual life table adding additional columns
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mi>x</mi><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>d</mi><mi>x</mi><mi>i</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>x</mi><mi>i</mi></msubsup><mspace width="0.222em"></mspace><mo>∀</mo><mspace width="0.222em"></mspace><mtext mathvariant="normal">causes</mtext><mspace width="0.222em"></mspace><mi>i</mi></mrow><annotation encoding="application/x-tex">q_x^i, d_x^i, l_x^i \ \forall \ \text{causes} \ i</annotation></semantics></math>)
for specific decrement causes. Note,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>x</mi></msub><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><msubsup><mi>m</mi><mi>x</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">m_x = \sum_i m_x^i</annotation></semantics></math>
and user should specify
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>
(the first array in the list). Let us use the shorten vesrion of data
from the previous example, using only overall
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>m</mi><mi>x</mi><mi>i</mi></msubsup><annotation encoding="application/x-tex">m_x^i</annotation></semantics></math>
from neoplasm.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">mx1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"neoplasms"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">age</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="va">mlt.res</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLT.html">MLT</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">mx</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mlt.res</span><span class="op">)</span></span>
<span><span class="co">#&gt;      age      mx    ax      qx      lx      dx      Lx       Tx    ex</span></span>
<span><span class="co">#&gt; [1,]   0 0.00762 0.134 0.00757 1.00000 0.00757 0.99899 74.65476 74.65</span></span>
<span><span class="co">#&gt; [2,]   1 0.00035 2.000 0.00141 0.99243 0.00140 3.96693 73.65578 74.22</span></span>
<span><span class="co">#&gt; [3,]   5 0.00017 2.500 0.00084 0.99103 0.00083 4.95310 69.68885 70.32</span></span>
<span><span class="co">#&gt; [4,]  10 0.00023 2.500 0.00115 0.99021 0.00114 4.94818 64.73574 65.38</span></span>
<span><span class="co">#&gt; [5,]  15 0.00094 2.500 0.00469 0.98907 0.00464 4.93373 59.78756 60.45</span></span>
<span><span class="co">#&gt; [6,]  20 0.00141 2.500 0.00702 0.98443 0.00691 4.90486 54.85384 55.72</span></span>
<span><span class="co">#&gt;      qx_neoplasms dx_neoplasms lx_neoplasms ex_no_neoplasms</span></span>
<span><span class="co">#&gt; [1,]      0.00003      0.00003      0.24395           84.29</span></span>
<span><span class="co">#&gt; [2,]      0.00012      0.00012      0.24392           83.93</span></span>
<span><span class="co">#&gt; [3,]      0.00015      0.00015      0.24380           80.03</span></span>
<span><span class="co">#&gt; [4,]      0.00015      0.00015      0.24365           75.08</span></span>
<span><span class="co">#&gt; [5,]      0.00021      0.00021      0.24350           70.14</span></span>
<span><span class="co">#&gt; [6,]      0.00030      0.00030      0.24329           65.40</span></span></code></pre></div>
<p>From this table one can calculate, for ex.,</p>
<ul>
<li>Proportion of newborn that will eventually die from cause i:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>l</mi><mn>0</mn><mi>i</mi></msubsup><mi>/</mi><msub><mi>l</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">l_0^i/l_0</annotation></semantics></math>
</li>
<li>Proportion of people who survive to age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
that will die from cause i:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>l</mi><mi>x</mi><mi>i</mi></msubsup><mi>/</mi><msub><mi>l</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">l_x^i/l_x</annotation></semantics></math>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="associated-single-decrement-life-table">Associated single decrement life table<a class="anchor" aria-label="anchor" href="#associated-single-decrement-life-table"></a>
</h3>
<p>There is <code><a href="../reference/asdt.html">asdt()</a></code> function that calculates <em>associated
single decrement life table</em> (ASDT) for causes of death
(<em>cause-deleted life table</em>). In other words, by this function
one can answer the question “what will be the life expectancy if there
is no mortality from cause i?” It is a natural expansion of Multiple
Decrement Life Table (<code>MLT</code> function, see above)</p>
<p>For example in the <code>demor</code> data (as it is easy to guess,
taken from <span class="citation">E. M. Andreev and Shkolnikov (<a href="#ref-and_sch_mdecomp">2012</a>)</span>) on mortality of US men in
2002 by some causes is added. Let me show what would be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>x</mi></msub><annotation encoding="application/x-tex">e_x</annotation></semantics></math>
if there is no deaths from neoplasm (i).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"asdtex"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">asdt_neoplasm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/asdt.html">asdt</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">age</span>, </span>
<span>                      sex <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                      m_all <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">all</span>, </span>
<span>                      m_i <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">neoplasms</span>, </span>
<span>                      full <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                      method <span class="op">=</span> <span class="st">"chiang1968"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">asdt_neoplasm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"ex"</span>, <span class="st">"ex_without_i"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age    ex ex_without_i</span></span>
<span><span class="co">#&gt; 1   0 74.65        84.29</span></span>
<span><span class="co">#&gt; 2   1 74.22        83.93</span></span>
<span><span class="co">#&gt; 3   5 70.32        80.03</span></span>
<span><span class="co">#&gt; 4  10 65.38        75.08</span></span>
<span><span class="co">#&gt; 5  15 60.45        70.14</span></span>
<span><span class="co">#&gt; 6  20 55.72        65.40</span></span></code></pre></div>
<p>One can plot the results using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">asdt_neoplasm</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">ex</span>, color <span class="op">=</span> <span class="st">"ex all"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">ex_without_i</span>, color <span class="op">=</span> <span class="st">"ex without neoplasms"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">asdt_neoplasm</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">lx</span>, color <span class="op">=</span> <span class="st">"lx all"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">l_not_i</span>, color <span class="op">=</span> <span class="st">"lx without neoplasms"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-19-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mortality-models-for-mx-approximation">Mortality models for mx approximation<a class="anchor" aria-label="anchor" href="#mortality-models-for-mx-approximation"></a>
</h3>
<p>In <code>demor</code> there is a function <code>mort.approx</code>
for modeling mx. Now “Gompertz” and “Brass” are supported (see Preston,
Heuveline &amp; Guillot, 2001 for more details on the functions).</p>
<p>Function returns list with estimated model and dataframe with
predicted mx.</p>
<p>The example below shows the model that try to approximate mx of
russian men in 2010 using Brass function and russian mortality of 2000
as standard mortality.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="va">rus2000</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2000</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">brass_2010</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mort.approx.html">mort.approx</a></span><span class="op">(</span>mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span>,</span>
<span>                          age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>,</span>
<span>                          model <span class="op">=</span> <span class="st">"Brass"</span>,</span>
<span>                          standard.mx <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">mx</span>,</span>
<span>                          sex <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span><span class="va">brass_2010</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: 0.5 * log((qx/(1 - qx))) ~ a + b * stand.logit</span></span>
<span><span class="co">#&gt;    data: parent.frame()</span></span>
<span><span class="co">#&gt;        a        b </span></span>
<span><span class="co">#&gt; -0.06074  1.07357 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 0.09628</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 1 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 1.178e-08</span></span></code></pre></div>
<p>Lets plot the modeled and observed mx.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brass_2010</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mx.pred</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"ln mx"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mort.approx.html">mort.approx</a></span><span class="op">(</span>mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>, age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span>, model <span class="op">=</span> <span class="st">"Gompertz"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="fertility">Fertility<a class="anchor" aria-label="anchor" href="#fertility"></a>
</h2>
<div class="section level3">
<h3 id="get-fertility-data">Get fertility data<a class="anchor" aria-label="anchor" href="#get-fertility-data"></a>
</h3>
<p>The data from <span class="citation"><span>“<span class="nocase">The
Russian Fertility and Mortality database</span>”</span> (<a href="#ref-rosbris">2024</a>)</span> is presented in the
<code>demor</code> as datasets in the long-format (mortality/fertility
by 1/5-year age groups from 1989 to 2022). Lets get basic <em>fertility
data</em> (asFR or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>)
from <code>demor</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbf</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_fertility_pop_1.html">rosbris_fertility_pop_1</a></span></span></code></pre></div>
<p>For the example Russia-2010 is as follows</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010f</span> <span class="op">&lt;-</span> <span class="va">dbf</span><span class="op">[</span><span class="va">dbf</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rus2010f</span><span class="op">)</span></span>
<span><span class="co">#&gt;       year code territory age       fx       N       Bx                 name</span></span>
<span><span class="co">#&gt; 16155 2010 1100         t  15 0.002828  718636  2032.30 Российская Федерация</span></span>
<span><span class="co">#&gt; 16156 2010 1100         t  16 0.007868  738942  5814.00 Российская Федерация</span></span>
<span><span class="co">#&gt; 16157 2010 1100         t  17 0.019538  806058 15748.76 Российская Федерация</span></span>
<span><span class="co">#&gt; 16158 2010 1100         t  18 0.036598  915096 33490.68 Российская Федерация</span></span>
<span><span class="co">#&gt; 16159 2010 1100         t  19 0.054816 1035519 56763.01 Российская Федерация</span></span>
<span><span class="co">#&gt; 16160 2010 1100         t  20 0.068020 1128146 76736.49 Российская Федерация</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tfr">TFR<a class="anchor" aria-label="anchor" href="#tfr"></a>
</h3>
<p>Now one can compute total fertility age (<em>TFR</em>) - the most
popular measure of fertility - that is standardized measure of “the
average number of children a woman would bear if she survived through
the end of the reproductive age span and experienced at each age a
particular set of age-specific fertility ages” <span class="citation">(<a href="#ref-preston">Preston, Heuveline, and Guillot
2001, 95</a>)</span>.</p>
<p>Surely, using <code>tfr</code> function one can compute TFR by parity
whereby using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>f</mi><mi>x</mi><mi>p</mi></msubsup><annotation encoding="application/x-tex">f_x^p</annotation></semantics></math>
instead of overall
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tfr.html">tfr</a></span><span class="op">(</span></span>
<span>  <span class="co">#asFR</span></span>
<span>  <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>,</span>
<span>  <span class="co">#age interval</span></span>
<span>  age.int <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.565588</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tempo-adjusted-tfr">Tempo-adjusted TFR<a class="anchor" aria-label="anchor" href="#tempo-adjusted-tfr"></a>
</h3>
<p>However, period “TFR is a very problematic measure for assessing both
the need for and the impact of policy changes and, more generally, for
studying fertility trends in conjunction with selected social and
economic trends” <span class="citation">(<a href="#ref-sobotka2010misleading">Sobotka and Lutz 2010,
639</a>)</span>. One correction to usual TFR is a tempo (meaning
fertility schedule) adjusted TFR, TFR’, proposed by <span class="citation">Bongaarts and Feeney (<a href="#ref-bongaarts_tfr1">1998</a>)</span> (see also <span class="citation">Bongaarts and Feeney (<a href="#ref-bongaarts_tfr2">2000</a>)</span>). To calculate it, one can
use <code>tatfr</code> function:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dbf5</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_fertility_pop_5.html">rosbris_fertility_pop_5</a></span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">code</span> <span class="op">==</span> <span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2009</span><span class="op">:</span><span class="fl">2011</span> <span class="op">&amp;</span> <span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">past_fx</span> <span class="op">=</span> <span class="va">dbf5</span><span class="op">[</span><span class="va">dbf5</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2009</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">present_fx</span> <span class="op">=</span> <span class="va">dbf5</span><span class="op">[</span><span class="va">dbf5</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2010</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">post_fx</span> <span class="op">=</span> <span class="va">dbf5</span><span class="op">[</span><span class="va">dbf5</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2011</span>,<span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/tatfr.html">tatfr</a></span><span class="op">(</span>past_fx <span class="op">=</span> <span class="va">past_fx</span>, present_fx <span class="op">=</span> <span class="va">present_fx</span>, post_fx <span class="op">=</span> <span class="va">post_fx</span>, age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">50</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $tatfr</span></span>
<span><span class="co">#&gt; [1] 1.726415</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tatfr_i</span></span>
<span><span class="co">#&gt; [1] 0.91379429 0.57933163 0.16968478 0.04180952 0.02179487</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tfr</span></span>
<span><span class="co">#&gt; [1] 1.584185</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tfr_i</span></span>
<span><span class="co">#&gt; [1] 0.799570 0.567745 0.156110 0.039510 0.021250</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mac">MAC<a class="anchor" aria-label="anchor" href="#mac"></a>
</h3>
<p>MAC is a mean age at childbearing. One can compute it using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>.
Surely, using <code>mac</code> function one can compute mean age at
childbearing by parity whereby using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>f</mi><mi>x</mi><mi>p</mi></msubsup><annotation encoding="application/x-tex">f_x^p</annotation></semantics></math>
instead of overall
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mac.html">mac</a></span><span class="op">(</span></span>
<span>  <span class="co">#asFR</span></span>
<span>  <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>,</span>
<span>  <span class="co">#array with ages</span></span>
<span>  age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 27.65</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fertility-models-for-asfr-approximation">Fertility models for ASFR approximation<a class="anchor" aria-label="anchor" href="#fertility-models-for-asfr-approximation"></a>
</h3>
<p>In <code>demor</code> there is a function <code>fert.approx</code>
for modeling ASFR. Now “Hadwiger”, “Gamma”, “Beta” and “Brass” are
supported (see <span class="citation">Peristera and Kostaki (<a href="#ref-peristera2007modeling">2007</a>)</span> for more details on
the functions).</p>
<p>Hadwiger model (optimal choice with balance of simplicity and
accuracy) is as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mi>b</mi></mrow><mi>c</mi></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>c</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>3</mn><mi>/</mi><mn>2</mn></mrow></msup><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><msup><mi>b</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>c</mi><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>a</mi><mi>g</mi><mi>e</mi></mrow><mi>c</mi></mfrac><mo>−</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">f(age) = \frac{ab}{c} (\frac{c}{age})^{3/2} exp[-b^2(\frac{c}{age}+\frac{age}{c}-2)]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a,b,c</annotation></semantics></math>
- parameters.</p>
<p>Gamma model (sophisticated and accurate, but not really sustainable
due to convergence issues) is as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>R</mi><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>c</mi><mi>b</mi></msup></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>a</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>d</mi></mrow><mi>c</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">f(age) = \frac{R}{\Gamma(b)c^b}(age-d)^{b-1} exp[-(\frac{age-d}{c})]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">R,b,c,d</annotation></semantics></math>
- parameters.</p>
<p>Beta model (sophisticated and even more accurate than Gamma, but not
really sustainable due to convergence issues) is as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>R</mi><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>+</mo><mi>C</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>B</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">f(age) = \frac{R}{B(A,C)}(\beta - \alpha)^{-(A+C-1)}(age - \alpha)^{(A-1)}(\beta - age)^{(B-1)}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B(.)</annotation></semantics></math>
is a beta function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">R, \beta, \alpha</annotation></semantics></math>
- parameters and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>v</mi><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mi>v</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msup><mi>τ</mi><mn>2</mn></msup></mfrac><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mfrac><mrow><mi>β</mi><mo>−</mo><mi>v</mi></mrow><mrow><mi>β</mi><mo>−</mo><mi>α</mi></mrow></mfrac><mo>,</mo><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>A</mi><mo>=</mo><mi>C</mi><mfrac><mrow><mi>v</mi><mo>−</mo><mi>α</mi></mrow><mrow><mi>β</mi><mo>−</mo><mi>v</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">C = (\frac{(v-\alpha)(\beta-v)}{\tau^2} -1)\frac{\beta - v}{\beta -\alpha}, \ \ \ A = C\frac{v-\alpha}{\beta - v}</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>,</mo><msup><mi>τ</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">v, \tau^2</annotation></semantics></math>
- parameters.</p>
<p>Brass model (the simplest and the most inaccurate) is as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo>+</mo><mi>w</mi><mo>−</mo><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(age) = c(age-d)(d+w-age)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>,</mo><mi>d</mi><mo>,</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">c,d,w</annotation></semantics></math>
- parameters.</p>
<p>Function returns list with estimated model and dataframe with
predicted ASFR.</p>
<p>The example below shows the model that try to approximate ASFR of
russian women in 2010 using Gamma function.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">approximation_2010</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Gamma"</span>, se <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">approximation_2010</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "Gamma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt;        R        b        c        d </span></span>
<span><span class="co">#&gt; 1.603196 8.517402 2.161279 9.043573 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $covmat</span></span>
<span><span class="co">#&gt;               [,1]          [,2]          [,3]          [,4]</span></span>
<span><span class="co">#&gt; [1,]  1.925014e+13 -1.957416e+06  4.238311e+06 -4.757733e+07</span></span>
<span><span class="co">#&gt; [2,] -1.957416e+06  8.352094e+01 -3.530959e+00 -3.494261e+01</span></span>
<span><span class="co">#&gt; [3,]  4.238311e+06 -3.530959e+00  3.685914e+00 -2.617387e+01</span></span>
<span><span class="co">#&gt; [4,] -4.757733e+07 -3.494261e+01 -2.617387e+01  2.616490e+02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prc</span></span>
<span><span class="co">#&gt;     prc.low  prc.high</span></span>
<span><span class="co">#&gt; R  1.563694  1.656541</span></span>
<span><span class="co">#&gt; b  6.303097 24.482427</span></span>
<span><span class="co">#&gt; c  1.272998  2.577443</span></span>
<span><span class="co">#&gt; d -6.864574 11.366677</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rmse</span></span>
<span><span class="co">#&gt; [1] 0.00301023</span></span></code></pre></div>
<p>Lets plot the modeled and observed ASFR with bootstrapped 95% CI. One
can see that model perfectly approximates real ASFR from 15 to 40 ages,
while after the fit is not really good.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="va">approximation_2010</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx.model</span>, color <span class="op">=</span> <span class="st">"fx from Gamma model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">prc.low</span>, ymax <span class="op">=</span> <span class="va">prc.high</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>Lets now do the same procedure but with Hadwiger function:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Hadwiger"</span>, se <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx.model</span>, color <span class="op">=</span> <span class="st">"fx from Hadwiger model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">prc.low</span>, ymax <span class="op">=</span> <span class="va">prc.high</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>Lets now do the same procedure but with Brass function:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Brass"</span>, se <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx.model</span>, color <span class="op">=</span> <span class="st">"fx from Brass model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">prc.low</span>, ymax <span class="op">=</span> <span class="va">prc.high</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>Lets now do the same procedure but with Beta function:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Beta"</span>, se <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fx.model</span>, color <span class="op">=</span> <span class="st">"fx from Beta model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">prc.low</span>, ymax <span class="op">=</span> <span class="va">prc.high</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h2>
<div class="section level3">
<h3 id="lee-carter-model">Lee-Carter model<a class="anchor" aria-label="anchor" href="#lee-carter-model"></a>
</h3>
<p>In the <code>demor</code> there is <code><a href="../reference/leecart.html">leecart()</a></code> function
that provides users with basic <em>Lee-Carter model</em> (proposed by
<span class="citation">Lee and Carter (<a href="#ref-leecarter">1992</a>)</span> and that now has a lot of
extensions, which are partially implemented in the <code>demor</code>,
see documentation) for mortality forecasting:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm.1</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_mortality_pop_1.html">rosbris_mortality_pop_1</a></span></span>
<span></span>
<span><span class="va">leecart_forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leecart.html">leecart</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2019</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"age"</span>, <span class="st">"mx"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                            n <span class="op">=</span> <span class="fl">3</span>, </span>
<span>                            sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>                            ax_method <span class="op">=</span> <span class="st">"classic"</span>,</span>
<span>                            bx_method <span class="op">=</span> <span class="st">"classic"</span>, </span>
<span>                            model <span class="op">=</span> <span class="st">"RWwD"</span>, </span>
<span>                            ktadj <span class="op">=</span> <span class="st">"none"</span></span>
<span>                            <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leecart_forecast</span><span class="op">$</span><span class="va">ex0</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2018</span><span class="op">)</span></span>
<span><span class="co">#&gt;        year e0.obs e0.hat conf.low conf.high</span></span>
<span><span class="co">#&gt; x.2018 2018  67.93  68.23       NA        NA</span></span>
<span><span class="co">#&gt; x.2019 2019  68.50  68.88    68.88     68.88</span></span>
<span><span class="co">#&gt; y.1    2020     NA  69.35    68.65     70.05</span></span>
<span><span class="co">#&gt; y.2    2021     NA  69.83    68.84     70.82</span></span>
<span><span class="co">#&gt; y.3    2022     NA  70.31    69.10     71.52</span></span></code></pre></div>
<p>One can plot the results using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a> to compare
predicted data with actual that, however, requires some data
handling:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#LE data calculation</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2020</span><span class="op">:</span><span class="fl">2022</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">leecart_forecast</span><span class="op">$</span><span class="va">ex0</span><span class="op">[</span><span class="va">leecart_forecast</span><span class="op">$</span><span class="va">ex0</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">e0.obs</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/LT.html">LT</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dbm</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, sex <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>       mx <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span> <span class="op">==</span> <span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"ex"</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">leecart_forecast</span><span class="op">$</span><span class="va">ex0</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2010</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">e0.obs</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">e0.obs</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">e0.hat</span>, color <span class="op">=</span> <span class="st">"Predicted\n(counterfactual)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">e0.hat</span>, color <span class="op">=</span> <span class="st">"Predicted\n(counterfactual)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">conf.low</span>, ymax <span class="op">=</span> <span class="va">conf.high</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"pink"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2019</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2024</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">58</span><span class="op">:</span><span class="fl">74</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_linedraw</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Male's LE at birth"</span>, colour <span class="op">=</span> <span class="st">"Data:"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>The comparison between different methods of Lee-Carter model
adjustment is presented below.</p>
<p><img src="demor_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="leslie-matrix-cohort-component-model">Leslie matrix &amp; Cohort-component model<a class="anchor" aria-label="anchor" href="#leslie-matrix-cohort-component-model"></a>
</h3>
<p>Leslie matrix is a powerful tool for demographic analysis that was
introduced by <span class="citation">Leslie (<a href="#ref-Leslie">1945</a>)</span>. For a nice and detailed
introduction to it and matrix projections in general, see <span class="citation">Wachter (<a href="#ref-ess_demor">2014</a>)</span>,
p. 98-122. Also see R package <a href="https://cran.r-project.org/web/packages/demogR/index.html" class="external-link"><code>demogR</code></a>
and its tutorial <span class="citation">(<a href="#ref-demogR">Jones
2007</a>)</span> for more on “matrix methods” in demography.</p>
<p>In the <code>demor</code> one can compute its using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>
that is age-specific mortality and fertility rates respectively.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mx</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span></span>
<span><span class="va">fx</span> <span class="op">&lt;-</span> <span class="va">dbf</span><span class="op">[</span><span class="va">dbf</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span>,<span class="op">]</span><span class="op">$</span><span class="va">fx</span></span>
<span></span>
<span><span class="va">les</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leslie.html">leslie</a></span><span class="op">(</span>mx <span class="op">=</span> <span class="va">mx</span>, fx <span class="op">=</span> <span class="va">fx</span>, age.mx <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, age.fx <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, fin <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="va">les</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.0000000 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [2,] 0.9964981 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.9996486 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.0000000 0.9997589 0.0000000    0</span></span>
<span><span class="co">#&gt; [5,] 0.0000000 0.0000000 0.0000000 0.9998292    0</span></span></code></pre></div>
<p>Leslie matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\pmb L</annotation></semantics></math>
can be expressed as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐋</mi><mo>=</mo><mi>𝐅</mi><mo>+</mo><mi>𝐌</mi></mrow><annotation encoding="application/x-tex">\pmb L = \pmb F + \pmb M</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐅</mi><annotation encoding="application/x-tex">\pmb F</annotation></semantics></math>
is the fertility component, which has nonzero values only across first
row, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\pmb M</annotation></semantics></math>
is the “survival” component, which is “shifted” down diagonal matrix.
From the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\pmb M</annotation></semantics></math>
one can compute life expectancy vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐞</mi><annotation encoding="application/x-tex">\pmb e</annotation></semantics></math>
as column sum of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐄</mi><annotation encoding="application/x-tex">\pmb E</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐄</mi><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐈</mi><mo>−</mo><mi>𝐌</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
\pmb E = (\pmb I - \pmb M)^{-1}
</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐞</mi><mo>=</mo><msup><mi>𝐄</mi><mi>T</mi></msup><mo>×</mo><mn>𝟏</mn></mrow><annotation encoding="application/x-tex">
\pmb e = \pmb E^T \times \pmb 1
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐈</mi><annotation encoding="application/x-tex">\pmb I</annotation></semantics></math>
is an identity matrix of the same size as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\pmb M</annotation></semantics></math>
(so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>𝟏</mn><annotation encoding="application/x-tex">\pmb 1</annotation></semantics></math>
is a column vector of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
of 1.</p>
<p>So, in the R it is</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M</span> <span class="op">&lt;-</span> <span class="va">les</span></span>
<span><span class="va">M</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">ex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">E</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ex</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]</span></span>
<span><span class="co">#&gt; [1,] 77.89959</span></span>
<span><span class="co">#&gt; [2,] 77.16983</span></span>
<span><span class="co">#&gt; [3,] 76.19661</span></span>
<span><span class="co">#&gt; [4,] 75.21474</span></span>
<span><span class="co">#&gt; [5,] 74.22741</span></span>
<span><span class="co">#&gt; [6,] 73.23845</span></span></code></pre></div>
<p>The graph below compares life expectancy at age x,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>x</mi></msub><annotation encoding="application/x-tex">e_x</annotation></semantics></math>,
from the usual life table and from Leslie matrix (they are almost
identical). However, there is a discrepancy in the last age group that
is, according to the life table, has higher life expectancy than in
Leslie model. This is because of the last age-group survival rate
calculating. In the classical Leslie model (default in
<code>leslie</code>) it is 0. It can be changed by assuming that it is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>x</mi></msub><mi>/</mi><msub><mi>T</mi><mrow><mi>x</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_x/T_{x-1}</annotation></semantics></math>
and then the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>x</mi></msub><annotation encoding="application/x-tex">e_x</annotation></semantics></math>
from life table and Leslie matrix will be identical (in
<code>leslie</code> one can write <code>fin = TRUE</code> to get this;
by default, it is <code>FALSE</code> as in this example).</p>
<p><img src="demor_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<p>Also from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\pmb L</annotation></semantics></math>
one can compute stable population properties: stable age distribution,
asymptotic growth rate, etc. For more details, references and functions
see <span class="citation">Jones (<a href="#ref-demogR">2007</a>)</span>, p. 10-24 where R package <a href="https://cran.r-project.org/web/packages/demogR/index.html" class="external-link"><code>demogR</code></a>
for matrix demographic models and their analysis was introduced. Below
is some simple example how to do it “by hand”:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">les</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="co"># largest real eigenvalue</span></span>
<span><span class="va">lvector</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">les</span><span class="op">)</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="co"># corresponding eigenvector</span></span>
<span><span class="va">stable_age</span> <span class="op">=</span> <span class="va">lvector</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">lvector</span><span class="op">)</span> <span class="co"># stable age distribution (normalized to sum to 1) </span></span></code></pre></div>
<p>The graph below compares observable and stable age distributions
<img src="demor_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<p>Finally, one of the most important implications of Leslie matrix is
the demographic projection in a concise and efficient matrix form.
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>𝐋</mi><mo>×</mo><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\pmb N(t+n) = \pmb L \times \pmb N(t)
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pmb N(t)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pmb N(t+n)</annotation></semantics></math>
are column-vectors of population in the time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>+</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">t+n</annotation></semantics></math>
respectively. If the mortality and fertility rates are constant over
time, the population in the last year of projection (of the horizon h)
is simply
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo>+</mo><mi>n</mi><mo>×</mo><mi>h</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>𝐋</mi><mi>h</mi></msup><mo>×</mo><mi>𝐍</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\pmb N(t_0+n \times h) = \pmb L^h \times \pmb N(t_0)
</annotation></semantics></math></p>
<p>Usually to calculate the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>𝐋</mi><mi>h</mi></msup><annotation encoding="application/x-tex">\pmb L^h</annotation></semantics></math>
it is easier (and more accurate) to use iterative procedure since the
modern computers are able to do it in a second (for reasonable horizon),
but one surely can diagonalize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\pmb L</annotation></semantics></math>
and find its transition matrix to reach more efficient (though less
accurate) calculations.</p>
<p>Below a function for the cohort-component model <code><a href="../reference/ccm.html">ccm()</a></code> is
presented. It requires matrix or dataframe of future
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>x</mi></msub><annotation encoding="application/x-tex">m_x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>f</mi><mi>x</mi></msub><annotation encoding="application/x-tex">f_x</annotation></semantics></math>;
and a vector with initial population. Optionally, one can provide the
function with matrix or dataframe of future net number of migrants, by
default it is NULL (closed population model without external migration).
To produce constant rates model, one need to make matrices with
identical columns, where each row is an age-specific rate and each
column in a period.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N0</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2022</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span></span>
<span></span>
<span><span class="va">const.mx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">mx</span>, each <span class="op">=</span> <span class="fl">79</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">const.fx</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">fx</span>, each <span class="op">=</span> <span class="fl">79</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fx</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Nt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ccm.html">ccm</a></span><span class="op">(</span>Mx.f <span class="op">=</span> <span class="va">const.mx</span>, Fx <span class="op">=</span> <span class="va">const.fx</span>, age.mx <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, age.fx <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, N0.f <span class="op">=</span> <span class="va">N0</span>, fin <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">2022</span><span class="op">:</span><span class="fl">2100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="co">#&gt;     2022     2023     2024     2025     2026     2027     2028     2029</span></span>
<span><span class="co">#&gt; 0 644191 615840.8 597083.2 580145.6 565349.8 552982.4 543233.6 536141.3</span></span>
<span><span class="co">#&gt; 1 675909 641935.1 613684.2 594992.3 578114.0 563370.0 551045.9 541331.2</span></span>
<span><span class="co">#&gt; 2 696760 675671.5 641709.5 613468.5 594783.2 577910.9 563172.0 550852.3</span></span>
<span><span class="co">#&gt; 3 736044 696592.0 675508.6 641554.8 613320.7 594639.8 577771.6 563036.2</span></span>
<span><span class="co">#&gt; 4 786765 735918.3 696473.1 675393.2 641445.3 613215.9 594538.2 577672.9</span></span>
<span><span class="co">#&gt; 5 856488 786646.4 735807.4 696368.1 675291.4 641348.6 613123.5 594448.6</span></span>
<span><span class="co">#&gt;       2030     2031</span></span>
<span><span class="co">#&gt; 0 531753.9 530166.4</span></span>
<span><span class="co">#&gt; 1 534263.8 529891.7</span></span>
<span><span class="co">#&gt; 2 541141.0 534076.0</span></span>
<span><span class="co">#&gt; 3 550719.5 541010.5</span></span>
<span><span class="co">#&gt; 4 562940.1 550625.4</span></span>
<span><span class="co">#&gt; 5 577585.8 562855.2</span></span></code></pre></div>
<p>And two graphs below show dynamics of total female population (in
mln) and female population age structure (in %) that converges to stable
population age structure.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">:</span><span class="fl">2100</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Nt</span><span class="op">)</span><span class="op">/</span><span class="fl">1e6</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"year"</span>, ylab <span class="op">=</span> <span class="st">"Female Population (mln)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nt</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">!</span><span class="va">age</span>, names_to <span class="op">=</span> <span class="st">"year"</span>, values_to <span class="op">=</span> <span class="st">"pop"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>pop.s <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pop</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">pop.s</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>group <span class="op">=</span> <span class="va">year</span>, color <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradient</span><span class="op">(</span>low <span class="op">=</span> <span class="st">"pink"</span>, high <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, stable_age <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">stable_age</span><span class="op">)</span>, </span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">stable_age</span>, linetype <span class="op">=</span> <span class="st">"Stable age\nstructure"</span><span class="op">)</span>, </span>
<span>            color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longdash"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"age"</span>, y <span class="op">=</span> <span class="st">"Age structure (%)"</span>, color <span class="op">=</span> <span class="st">"Year:"</span>, linetype <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h2>
<div class="section level3">
<h3 id="population-pyramid">Population pyramid<a class="anchor" aria-label="anchor" href="#population-pyramid"></a>
</h3>
<p><code>plot_pyr</code> plots population pyramid using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a></p>
<p>Lets create population pyramid using midyear population from Rosbris
mortality data. We already have data in <code>dbm</code>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/plot_pyr.html">plot_pyr</a></span><span class="op">(</span></span>
<span>  popm <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popf <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>, </span>
<span>  age <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<p>Also one can redesigned plot using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a> commands. Also
one can plot additional population (<code>popm2</code> and
<code>popf2</code>) pyramid as dashed line that can be helpful for
comparisons.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/plot_pyr.html">plot_pyr</a></span><span class="op">(</span></span>
<span>  popm <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popf <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popm2 <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popf2 <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2022</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  age <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"My y-axis"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"My age"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Data sourse: Rosbris"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Russian population in 2010"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"m"</span><span class="op">)</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"lightblue"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Gender:"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="median-age">Median age<a class="anchor" aria-label="anchor" href="#median-age"></a>
</h3>
<p>Also one can compute median age of some population, using vectors of
population sizes in the age groups and that age groups.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Using 1-year age interval</span></span>
<span><span class="fu"><a href="../reference/med.age.html">med.age</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>        age <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span>,</span>
<span>        int <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.97</span></span>
<span></span>
<span><span class="co">#Using 5-year age interval</span></span>
<span><span class="fu"><a href="../reference/med.age.html">med.age</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>        age <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span>,</span>
<span>        int <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.99</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Drewnowski" class="csl-entry">
Aburto, José Manuel, Ugofilippo Basellini, Annette Baudisch, and
Francisco Villavicencio. 2022. <span>“Drewnowski’s Index to Measure
Lifespan Variation: Revisiting the Gini Coefficient of the Life
Table.”</span> <em>Theoretical Population Biology</em> 148: 1–10. <a href="https://doi.org/10.1016/j.tpb.2022.08.003" class="external-link">https://doi.org/10.1016/j.tpb.2022.08.003</a>.
</div>
<div id="ref-and_sch_mdecomp" class="csl-entry">
Andreev, E. M., and V. M. Shkolnikov. 2012. <span>“An Excel Spreadsheet
for the Decomposition of a Difference Between Two Values of an Aggregate
Demographic Measure by Stepwise Replacement Running from Young to Old
Ages.”</span> Rostock: Max Planck Institute for Demographic Research. <a href="https://www.demogr.mpg.de/en/publications_databases_6118/publications_1904/mpidr_technical_reports/an_excel_spreadsheet_for_the_decomposition_of_a_difference_between_two_values_of_an_aggregate_demographic_4591" class="external-link">https://www.demogr.mpg.de/en/publications_databases_6118/publications_1904/mpidr_technical_reports/an_excel_spreadsheet_for_the_decomposition_of_a_difference_between_two_values_of_an_aggregate_demographic_4591</a>.
</div>
<div id="ref-Andreev_ax" class="csl-entry">
Andreev, Evgeny M., and W. Ward Kingkade. 2015. <span>“<span class="nocase">Average age at death in infancy and infant mortality
level: Reconsidering the Coale-Demeny formulas at current levels of low
mortality</span>.”</span> <em>Demographic Research</em> 33 (13): 363–90.
<a href="https://doi.org/10.4054/DemRes.2015.33.13" class="external-link">https://doi.org/10.4054/DemRes.2015.33.13</a>.
</div>
<div id="ref-arriaga_dec" class="csl-entry">
Arriaga, Eduardo E. 1984. <span>“Measuring and Explaining the Change in
Life Expectancies.”</span> <em>Demography</em> 21 (1): 83–96. <a href="https://doi.org/10.2307/2061029" class="external-link">https://doi.org/10.2307/2061029</a>.
</div>
<div id="ref-bongaarts_tfr1" class="csl-entry">
Bongaarts, John, and Griffith Feeney. 1998. <span>“On the Quantum and
Tempo of Fertility.”</span> <em>Population and Development Review</em>,
271–91.
</div>
<div id="ref-bongaarts_tfr2" class="csl-entry">
———. 2000. <span>“On the Quantum and Tempo of Fertility: Reply.”</span>
<em>Population and Development Review</em> 26 (3): 560–64.
</div>
<div id="ref-hli" class="csl-entry">
Ghislandi, Simone, Warren C. Sanderson, and Sergei Scherbov. 2019.
<span>“A Simple Measure of Human Development: The Human Life
Indicator.”</span> <em>Population and Development Review</em> 45 (1):
219–33. <a href="https://doi.org/10.1111/padr.12205" class="external-link">https://doi.org/10.1111/padr.12205</a>.
</div>
<div id="ref-hanada_gini" class="csl-entry">
Hanada, Kyo. 1983. <span>“A Formula of Gini’s Concentration Ratio and
Its Application to Life Tables.”</span> <em>Journal of the Japan
Statistical Society, Japanese Issue</em> 13 (2): 95–98. <a href="https://doi.org/10.11329/jjss1970.13.95" class="external-link">https://doi.org/10.11329/jjss1970.13.95</a>.
</div>
<div id="ref-demogR" class="csl-entry">
Jones, James Holland. 2007. <span>“demogR: A Package for the
Construction and Analysis of Age-Structured Demographic Models in
r.”</span> <em>Journal of Statistical Software</em> 22 (10): 1–28. <a href="https://doi.org/10.18637/jss.v022.i10" class="external-link">https://doi.org/10.18637/jss.v022.i10</a>.
</div>
<div id="ref-leecarter" class="csl-entry">
Lee, Ronald D, and Lawrence R Carter. 1992. <span>“Modeling and
Forecasting US Mortality.”</span> <em>Journal of the American
Statistical Association</em> 87 (419): 659–71. <a href="https://doi.org/10.1080/01621459.1992.10475265" class="external-link">https://doi.org/10.1080/01621459.1992.10475265</a>.
</div>
<div id="ref-Leslie" class="csl-entry">
Leslie, P. H. 1945. <span>“On the Use of Matrices in Certain Population
Mathematics.”</span> <em>Biometrika</em> 33 (3): 183–212. <a href="https://doi.org/10.2307/2332297" class="external-link">https://doi.org/10.2307/2332297</a>.
</div>
<div id="ref-yll" class="csl-entry">
Martinez, Ramon, Patricia Soliz, Roberta Caixeta, and Pedro Ordunez.
2019. <span>“Reflection on Modern Methods: Years of Life Lost Due to
Premature Mortality—a Versatile and Comprehensive Measure for Monitoring
Non-Communicable Disease Mortality.”</span> <em>International Journal of
Epidemiology</em> 48 (4): 1367–76. <a href="https://doi.org/10.1093/ije/dyy254" class="external-link">https://doi.org/10.1093/ije/dyy254</a>.
</div>
<div id="ref-peristera2007modeling" class="csl-entry">
Peristera, Paraskevi, and Anastasia Kostaki. 2007. <span>“Modeling
Fertility in Modern Populations.”</span> <em>Demographic Research</em>
16: 141–94. <a href="https://doi.org/10.4054/DemRes.2007.16.6" class="external-link">https://doi.org/10.4054/DemRes.2007.16.6</a>.
</div>
<div id="ref-pollard_dec" class="csl-entry">
Pollard, John H. 1982. <span>“The Expectation of Life and Its
Relationship to Mortality.”</span> <em>Journal of the Institute of
Actuaries</em> 109 (2): 225–40.
</div>
<div id="ref-preston" class="csl-entry">
Preston, Samuel H., Patrix Heuveline, and Michel Guillot. 2001.
<em>Demography: Measuring and Modeling Population Process</em>. Malden:
Blackwell.
</div>
<div id="ref-Shkolnikov_gini" class="csl-entry">
Shkolnikov, Vladimir, Evgeny M. Andreev, and Alexander Begun. 2003.
<span>“<span class="nocase">Gini coefficient as a life table function:
Computation from discrete data, decomposition of differences and
empirical examples</span>.”</span> <em>Demographic Research</em> 8 (11):
305–58. <a href="https://doi.org/10.4054/DemRes.2003.8.11" class="external-link">https://doi.org/10.4054/DemRes.2003.8.11</a>.
</div>
<div id="ref-sobotka2010misleading" class="csl-entry">
Sobotka, Tomáš, and Wolfgang Lutz. 2010. <span>“Misleading Policy
Messages Derived from the Period TFR: Should We Stop Using It?”</span>
<em>Comparative Population Studies</em> 35 (3).
</div>
<div id="ref-rosbris" class="csl-entry">
<span>“<span class="nocase">The Russian Fertility and Mortality
database</span>.”</span> 2024. <em>Database</em>. The Centre for
Demographic Research at the New Economic School. <a href="http://demogr.nes.ru/index.php/ru/demogr_indicat/data" class="external-link">http://demogr.nes.ru/index.php/ru/demogr_indicat/data</a>.
</div>
<div id="ref-edagger" class="csl-entry">
Vaupel, James W, and Vladimir Canudas Romo. 2003. <span>“Decomposing
Change in Life Expectancy: A Bouquet of Formulas in Honor of Nathan
Keyfitz’s 90th Birthday.”</span> <em>Demography</em> 40: 201–16. <a href="https://doi.org/10.1353/dem.2003.0018" class="external-link">https://doi.org/10.1353/dem.2003.0018</a>.
</div>
<div id="ref-ess_demor" class="csl-entry">
Wachter, Kenneth W. 2014. <em>Essential Demographic Methods</em>.
Harvard University Press.
</div>
<div id="ref-comp_ineq1" class="csl-entry">
Wilmoth, John R, and Shiro Horiuchi. 1999. <span>“Rectangularization
Revisited: Variability of Age at Death Within Human Populations.”</span>
<em>Demography</em> 36 (4): 475–95. <a href="https://doi.org/10.2307/2648085" class="external-link">https://doi.org/10.2307/2648085</a>.
</div>
<div id="ref-comp_ineq2" class="csl-entry">
Wrycza, Tomasz F, Trifon I Missov, and Annette Baudisch. 2015.
<span>“Quantifying the Shape of Aging.”</span> <em>PloS One</em> 10 (3):
e0119163. <a href="https://doi.org/10.1371/journal.pone.0119163" class="external-link">https://doi.org/10.1371/journal.pone.0119163</a>.
</div>
<div id="ref-andreev_dec" class="csl-entry">
Андреев, ЕМ. 1982. <span>“Метод Компонент в Анализе Продолжительности
Жизни.”</span> <em>Вестник Статистики</em> 9: 42–47.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vadim Ustyuzhanin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
