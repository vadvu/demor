<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get started with `demor` • demor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Get started with `demor`">
<meta property="og:description" content="demor">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">demor</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/demor.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Get started with <code>demor</code>
</h1>
            
      
      
      <div class="hidden name"><code>demor.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>demor</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"vadvu/demor"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-rosbris-data">Get Rosbris data<a class="anchor" aria-label="anchor" href="#get-rosbris-data"></a>
</h2>
<p><strong>DEPRECATED</strong></p>
<p>For getting data from <a href="http://demogr.nes.ru/index.php/ru/demogr_indicat/data" class="external-link">RosBris</a>
there is a function <code><a href="../reference/get_rosbris.html">get_rosbris()</a></code> that can download data on
mortality/fertility by 1/5-year age groups from 1989 to the last
available year (in 2023 its 2022).<br>
Worth noting: downloading and preparing the final file can get some
time.<br>
In the chunk below mortality data (<code>type = "m"</code>, for
fertility see <a href="#get-fertility-data">Fertility section</a>) for
1-age groups with population in “long” format is loading. For more
function description use <code><a href="../reference/get_rosbris.html">?get_rosbris</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dbm &lt;- get_rosbris(</span></span>
<span><span class="co">#   #mortality data</span></span>
<span><span class="co">#   type = "m",</span></span>
<span><span class="co">#   #what age group download</span></span>
<span><span class="co">#   age =  1,</span></span>
<span><span class="co">#   #to get "long" data</span></span>
<span><span class="co">#   initial = F,</span></span>
<span><span class="co">#   #last available year (the name of the downloading file contains years, so for the downloading the last year is required)</span></span>
<span><span class="co">#   lastyear = 2022</span></span>
<span><span class="co"># )</span></span></code></pre></div>
<p>Recently RosBris has been switched to new website, so the function
<code>get_rosbris</code> does not work now. I hope in a several months
all mistakes due to new website will be fixed and function will
work.</p>
<p>Now RosBris data is presented in the <code>demor</code> as datasets
in the long-format. The example of usage that replicates the data from
the previous chunk with <code>get_rosbris</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_mortality_pop_5.html">rosbris_mortality_pop_5</a></span></span>
<span></span>
<span><span class="co"># for 1-year age interval</span></span>
<span><span class="co"># dbm &lt;- demor::rosbris_mortality_pop_1</span></span></code></pre></div>
<p>Lets see the data for Russia in 2010 for males and for total
population (both urban and rural)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;       year code territory sex age       mx       N        Dx</span></span>
<span><span class="co">#&gt; 20445 2010 1100         t   m   0 0.008823  869388   7670.61</span></span>
<span><span class="co">#&gt; 20446 2010 1100         t   m   1 0.000604 3222450   1946.36</span></span>
<span><span class="co">#&gt; 20447 2010 1100         t   m   5 0.000355 3613276   1282.71</span></span>
<span><span class="co">#&gt; 20448 2010 1100         t   m  10 0.000387 3398894   1315.37</span></span>
<span><span class="co">#&gt; 20449 2010 1100         t   m  15 0.001186 4353344   5163.07</span></span>
<span><span class="co">#&gt; 20450 2010 1100         t   m  20 0.002546 6193325  15768.21</span></span>
<span><span class="co">#&gt; 20451 2010 1100         t   m  25 0.004491 6002262  26956.16</span></span>
<span><span class="co">#&gt; 20452 2010 1100         t   m  30 0.006808 5395865  36735.05</span></span>
<span><span class="co">#&gt; 20453 2010 1100         t   m  35 0.007934 4973298  39458.15</span></span>
<span><span class="co">#&gt; 20454 2010 1100         t   m  40 0.009782 4464789  43674.57</span></span>
<span><span class="co">#&gt; 20455 2010 1100         t   m  45 0.013354 5140274  68643.22</span></span>
<span><span class="co">#&gt; 20456 2010 1100         t   m  50 0.018567 5207919  96695.43</span></span>
<span><span class="co">#&gt; 20457 2010 1100         t   m  55 0.026250 4333619 113757.50</span></span>
<span><span class="co">#&gt; 20458 2010 1100         t   m  60 0.037143 3117320 115786.62</span></span>
<span><span class="co">#&gt; 20459 2010 1100         t   m  65 0.049925 1573662  78565.08</span></span>
<span><span class="co">#&gt; 20460 2010 1100         t   m  70 0.068599 2149929 147482.98</span></span>
<span><span class="co">#&gt; 20461 2010 1100         t   m  75 0.097635 1077916 105242.33</span></span>
<span><span class="co">#&gt; 20462 2010 1100         t   m  80 0.138043  714191  98589.07</span></span>
<span><span class="co">#&gt; 20463 2010 1100         t   m  85 0.198593  231350  45944.49</span></span>
<span><span class="co">#&gt;                       name</span></span>
<span><span class="co">#&gt; 20445 Российская Федерация</span></span>
<span><span class="co">#&gt; 20446 Российская Федерация</span></span>
<span><span class="co">#&gt; 20447 Российская Федерация</span></span>
<span><span class="co">#&gt; 20448 Российская Федерация</span></span>
<span><span class="co">#&gt; 20449 Российская Федерация</span></span>
<span><span class="co">#&gt; 20450 Российская Федерация</span></span>
<span><span class="co">#&gt; 20451 Российская Федерация</span></span>
<span><span class="co">#&gt; 20452 Российская Федерация</span></span>
<span><span class="co">#&gt; 20453 Российская Федерация</span></span>
<span><span class="co">#&gt; 20454 Российская Федерация</span></span>
<span><span class="co">#&gt; 20455 Российская Федерация</span></span>
<span><span class="co">#&gt; 20456 Российская Федерация</span></span>
<span><span class="co">#&gt; 20457 Российская Федерация</span></span>
<span><span class="co">#&gt; 20458 Российская Федерация</span></span>
<span><span class="co">#&gt; 20459 Российская Федерация</span></span>
<span><span class="co">#&gt; 20460 Российская Федерация</span></span>
<span><span class="co">#&gt; 20461 Российская Федерация</span></span>
<span><span class="co">#&gt; 20462 Российская Федерация</span></span>
<span><span class="co">#&gt; 20463 Российская Федерация</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mortality">Mortality<a class="anchor" aria-label="anchor" href="#mortality"></a>
</h2>
<div class="section level3">
<h3 id="life-table">Life table<a class="anchor" aria-label="anchor" href="#life-table"></a>
</h3>
<p>Now one can create <em>life table</em> based on gotten data for
2010-Russia using <code><a href="../reference/LT.html">LT()</a></code>.<br>
Note, <span class="math inline">\(a_x\)</span> for age 0 is modeled as
in Andreev &amp; Kingkade (<a href="https://doi.org/10.4054/DemRes.2015.33.13" class="external-link">2015</a>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/LT.html">LT</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>, </span>
<span>  sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>  <span class="co">#age specific mortality rates</span></span>
<span>  mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span></span>
<span><span class="co">#&gt;       age      mx    ax      qx      lx      dx      Lx       Tx    ex</span></span>
<span><span class="co">#&gt;  [1,]   0 0.00882 0.132 0.00876 1.00000 0.00876 0.99240 63.03477 63.03</span></span>
<span><span class="co">#&gt;  [2,]   1 0.00060 0.500 0.00241 0.99124 0.00239 3.96019 62.04238 62.59</span></span>
<span><span class="co">#&gt;  [3,]   5 0.00036 0.500 0.00177 0.98885 0.00175 4.93988 58.08218 58.74</span></span>
<span><span class="co">#&gt;  [4,]  10 0.00039 0.500 0.00193 0.98710 0.00191 4.93072 53.14231 53.84</span></span>
<span><span class="co">#&gt;  [5,]  15 0.00119 0.500 0.00591 0.98519 0.00582 4.91139 48.21159 48.94</span></span>
<span><span class="co">#&gt;  [6,]  20 0.00255 0.500 0.01265 0.97937 0.01239 4.86586 43.30020 44.21</span></span>
<span><span class="co">#&gt;  [7,]  25 0.00449 0.500 0.02221 0.96698 0.02147 4.78120 38.43434 39.75</span></span>
<span><span class="co">#&gt;  [8,]  30 0.00681 0.500 0.03347 0.94550 0.03165 4.64841 33.65314 35.59</span></span>
<span><span class="co">#&gt;  [9,]  35 0.00793 0.500 0.03890 0.91386 0.03555 4.48042 29.00473 31.74</span></span>
<span><span class="co">#&gt; [10,]  40 0.00978 0.500 0.04774 0.87831 0.04193 4.28672 24.52431 27.92</span></span>
<span><span class="co">#&gt; [11,]  45 0.01335 0.500 0.06461 0.83638 0.05404 4.04679 20.23759 24.20</span></span>
<span><span class="co">#&gt; [12,]  50 0.01857 0.500 0.08872 0.78234 0.06941 3.73817 16.19080 20.70</span></span>
<span><span class="co">#&gt; [13,]  55 0.02625 0.500 0.12317 0.71293 0.08781 3.34513 12.45263 17.47</span></span>
<span><span class="co">#&gt; [14,]  60 0.03714 0.500 0.16994 0.62512 0.10623 2.86003  9.10751 14.57</span></span>
<span><span class="co">#&gt; [15,]  65 0.04992 0.500 0.22193 0.51889 0.11516 2.30657  6.24748 12.04</span></span>
<span><span class="co">#&gt; [16,]  70 0.06860 0.500 0.29278 0.40374 0.11821 1.72316  3.94091  9.76</span></span>
<span><span class="co">#&gt; [17,]  75 0.09764 0.500 0.39240 0.28553 0.11204 1.14754  2.21775  7.77</span></span>
<span><span class="co">#&gt; [18,]  80 0.13804 0.500 0.51313 0.17349 0.08902 0.64489  1.07021  6.17</span></span>
<span><span class="co">#&gt; [19,]  85 0.19859 5.035 1.00000 0.08447 0.08447 0.42532  0.42532  5.04</span></span></code></pre></div>
<p>Note, from life table one can compute other <em>functions</em> (not
just <span class="math inline">\(e_x\)</span> or <span class="math inline">\(l_x\)</span>) and interesting things:  <br>
1. <span class="math inline">\(CDR = \frac{1}{e_0}\)</span> or Death
rate above some age <span class="math inline">\(x: 1/e_x\)</span><br>
2. Probability of surviving from age <span class="math inline">\(x\)</span> to age <span class="math inline">\(y\)</span>: <span class="math inline">\(p=l_y/l_x\)</span><br>
3. Probability that a newborn will die between ages <span class="math inline">\(x\)</span> and <span class="math inline">\(x+n\)</span>: <span class="math inline">\(d_x^n/l_0\)</span><br>
4. Probability that a newborn will die between ages <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>: <span class="math inline">\((l_x-l_y)/l_0\)</span><br>
5. Life course ratio from age <span class="math inline">\(x\)</span> to
<span class="math inline">\(y\)</span> that is the fraction of
person-years lived from age <span class="math inline">\(x\)</span>
onward: <span class="math inline">\(T_y/T_x\)</span><br>
6. Crude estimate of the number of births needed to “replace” expected
deaths: <span class="math inline">\(P/e_0\)</span> where <span class="math inline">\(P\)</span> is total population  <br>
See also Demography handbook by Preston, Heuveline and Guillot <a href="https://gwern.net/doc/statistics/2001-preston-demography.pdf" class="external-link">(2001,
p. 38-71)</a></p>
</div>
<div class="section level3">
<h3 id="human-life-indicator-hli">Human Life Indicator (HLI)<a class="anchor" aria-label="anchor" href="#human-life-indicator-hli"></a>
</h3>
<p>A good alternative to the <em>human development indicator</em> (HDI)
is the <em>human life indicator</em> (HLI) proposed by Ghislandi,
Sanderson and Scherbov (<a href="https://doi.org/10.1111/padr.12205" class="external-link">2019</a>). It requires just
<span class="math inline">\(m_x\)</span> (and it is based on <em>life
table</em>). It is calculated as geometric mean of lifespans: <span class="math display">\[HLI = \prod_x^\omega{(x+a_x)^{d_x}}\]</span>
where <em>x</em> is age and <em>a</em>, <em>d</em> are functions from
<em>life table</em>.</p>
<p>Lets calculate it using our example data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hli.html">hli</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>, </span>
<span>  sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>  mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 55.19236</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="years-of-life-lost-yll">Years of Life Lost (YLL)<a class="anchor" aria-label="anchor" href="#years-of-life-lost-yll"></a>
</h3>
<p>One of the most popular (and relatively young) measure of
<em>lifespan inequality</em> is “<em>years of life lost</em>” (YLL)
proposed by Martinez et al. (<a href="https://doi.org/10.1093/ije/dyy254" class="external-link">2019</a>). As authors claim,
“YLL is a valuable measure for public health surveillance, particularly
for quantifying the level and trends of premature mortality,
identification of leading causes of premature deaths and monitoring the
progress of YLL as a key indicator of population health” (ibid.,
1368).</p>
<p>Authors proposed different metrics of <em>YLL</em>:<br>
1. Absolute number of <em>YLL</em>: <span class="math display">\[YLL_{x,t,c}=D_{x,t,c}*SLE_x\]</span> that is
calculated for age <em>x</em>, time <em>t</em> and cause of death
<em>c</em>. <em>YLL</em> for the whole population is just sum of <span class="math inline">\(YLL_x\)</span>. <em>SLE</em> is the <em>standard
life expectancy</em> that is invariant over time, sex and population
(it’s meaning is straightforward: it is the potential maximum life span
of an individual, who is not exposed to avoidable health risks or severe
injuries and receives appropriate health services), and <span class="math inline">\(D_x\)</span> is a number of deaths at age
<em>x</em>. Of course, one can calculate <em>YLL</em> not for specific
cause <em>c</em>, but for overall mortality that is called
<em>all-causes YLL</em>.<br>
2. <em>YLL</em> as proportion: <span class="math display">\[YLL^p_{x,t,c}=YLL_{x,t,c}/YLL_{x,t}\]</span> that
is just <em>cause specific YLL</em> divided by <em>all-causes
YLL</em>.<br>
3. <em>YLL</em> rate: <span class="math display">\[YLL^r_{x,t,c}=[YLL_{x,t,c}/P_{x,t}] *
100'000\]</span> where <span class="math inline">\(P_{x,t}\)</span>
is population.<br>
4. Age-standardized <em>YLL</em> rate: <span class="math display">\[ASYR_{x,t,c} =
\sum_x^\omega{[YLL^r_{x,t,c}*W_x]}\]</span> where <span class="math inline">\(W_x\)</span> is the standard population weight at
age <em>x</em>, where <span class="math inline">\(\omega\)</span> is the
oldest, closing age (for ex., 85+ or 100+). In other words, it’s just
direct standardization of <span class="math inline">\(YLL^r_{x,t,c}\)</span>.</p>
<p>Let’s calculate all-cause <em>YLL</em>, <em>Yll rate</em> and
<em>ASYR</em> using Rosbris data that we have downloaded.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#YLL</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"yll"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $yll_all</span></span>
<span><span class="co">#&gt; [1] 33640561</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $yll</span></span>
<span><span class="co">#&gt;  [1]  705159.2  174024.0  108414.6  104611.4  384855.2 1096994.4 1741367.9</span></span>
<span><span class="co">#&gt;  [8] 2190511.0 2157177.1 2171936.4 3075902.7 3860081.6 3989475.5 3502545.3</span></span>
<span><span class="co">#&gt; [15] 2002623.9 3063221.5 1729131.5 1233349.3  349178.1</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#YLL rate</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"yll.r"</span>, pop <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="co">#&gt; $yll.r_all</span></span>
<span><span class="co">#&gt; [1] 50945.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $yll.r</span></span>
<span><span class="co">#&gt;  [1]  81109.836   5400.365   3000.453   3077.806   8840.451  17712.527</span></span>
<span><span class="co">#&gt;  [7]  29011.861  40596.105  43375.182  48645.890  59839.275  74119.462</span></span>
<span><span class="co">#&gt; [13]  92058.751 112357.578 127258.833 142480.124 160414.307 172691.796</span></span>
<span><span class="co">#&gt; [19] 150930.678</span></span></code></pre></div>
<p>For <em>ASYR</em> one needs standard population. Let’s use 2010
population as standard (note, in this case <em>ASYR</em> equals <em>YLL
rate</em> because we use 2010 mortality).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#ASYR</span></span>
<span><span class="fu"><a href="../reference/yll.html">yll</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">Dx</span>, type <span class="op">=</span> <span class="st">"asyr"</span>, pop <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span>, w <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rus2010</span><span class="op">$</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $asyr</span></span>
<span><span class="co">#&gt;  [1] 1067.8879  263.5407  164.1824  158.4227  582.8220 1661.2803 2637.1149</span></span>
<span><span class="co">#&gt;  [8] 3317.2939 3266.8132 3289.1646 4658.1245 5845.6793 6041.6326 5304.2289</span></span>
<span><span class="co">#&gt; [15] 3032.7590 4638.9202 2618.5841 1867.7751  528.7928</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $asyr_all</span></span>
<span><span class="co">#&gt; [1] 50945.02</span></span></code></pre></div>
<p>Also one can calculate different <em>YLL</em> measures using
standards that are provided by <code>demor</code> as dataframe.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/sle_stand.html">sle_stand</a></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="age-decomposition-of-differences-in-life-expectancies">Age decomposition of differences in life expectancies<a class="anchor" aria-label="anchor" href="#age-decomposition-of-differences-in-life-expectancies"></a>
</h3>
<p>Also one can do simple <em>decomposition</em> between 2 populations.
Lets use Russia-2000 as <em>base population</em> and Russia-2010 as
<em>compared population</em></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="va">rus2000</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2000</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decomp.html">decomp</a></span><span class="op">(</span>mx1 <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">mx</span>, </span>
<span>              mx2 <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span>, </span>
<span>              sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>              age <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">age</span>, </span>
<span>              method <span class="op">=</span> <span class="st">"andreev"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dec</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age   ex1   ex2     lx2  dex ex12  ex12_prc</span></span>
<span><span class="co">#&gt; 1   0 58.98 63.03 1.00000 4.05 0.53 13.022113</span></span>
<span><span class="co">#&gt; 2   1 59.04 62.59 0.99124 3.55 0.11  2.702703</span></span>
<span><span class="co">#&gt; 3   5 55.29 58.74 0.98885 3.45 0.07  1.719902</span></span>
<span><span class="co">#&gt; 4  10 50.45 53.84 0.98710 3.39 0.05  1.228501</span></span>
<span><span class="co">#&gt; 5  15 45.59 48.94 0.98519 3.35 0.21  5.159705</span></span>
<span><span class="co">#&gt; 6  20 41.05 44.21 0.97937 3.16 0.45 11.056511</span></span></code></pre></div>
<p>Than let us plot the result of <code>decomp</code> using
<code>ggplot2</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dec</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="va">ex12</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"orange3"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age-groups"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Сontribution to the e0 difference"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="st">"70"</span>, y <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Total difference in e0: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dec</span><span class="op">$</span><span class="va">ex12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ex12</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="fl">1.5</span>, color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-11-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="age-and-cause-decomposition-of-differences-in-life-expectancies">Age and cause decomposition of differences in life expectancies<a class="anchor" aria-label="anchor" href="#age-and-cause-decomposition-of-differences-in-life-expectancies"></a>
</h3>
<p>Also one can do <em>decomposition</em> between 2 populations by
<em>age</em> and <em>causes</em>. Lets use example from Andreev &amp;
Shkolnikov <a href="https://www.demogr.mpg.de/en/publications_databases_6118/publications_1904/mpidr_technical_reports/an_excel_spreadsheet_for_the_decomposition_of_a_difference_between_two_values_of_an_aggregate_demographic_4591" class="external-link">spreadsheet</a>
where data for US and England and Wales men mortality by some causes are
presented.<br>
Lets see the data</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mdecompex"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mdecompex</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;     age neoplasms circulatory respiratory  digestive  accident     other     all</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0 0.000<span style="text-decoration: underline;">034</span>9  0.000<span style="text-decoration: underline;">173</span>    0.000<span style="text-decoration: underline;">188</span>   0.000<span style="text-decoration: underline;">151</span>   0.000<span style="text-decoration: underline;">377</span>  0.006<span style="text-decoration: underline;">69</span>   7.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1 0.000<span style="text-decoration: underline;">030</span>9  0.000<span style="text-decoration: underline;">015</span>5   0.000<span style="text-decoration: underline;">022</span>0  0.000<span style="text-decoration: underline;">009</span>30 0.000<span style="text-decoration: underline;">163</span>  0.000<span style="text-decoration: underline;">112</span>  3.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     5 0.000<span style="text-decoration: underline;">031</span>3  0.000<span style="text-decoration: underline;">005</span>60  0.000<span style="text-decoration: underline;">006</span>87 0.000<span style="text-decoration: underline;">003</span>24 0.000<span style="text-decoration: underline;">079</span>2 0.000<span style="text-decoration: underline;">040</span>9 1.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    10 0.000<span style="text-decoration: underline;">030</span>5  0.000<span style="text-decoration: underline;">012</span>7   0.000<span style="text-decoration: underline;">008</span>96 0.000<span style="text-decoration: underline;">002</span>86 0.000<span style="text-decoration: underline;">127</span>  0.000<span style="text-decoration: underline;">049</span>0 2.31<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    15 0.000<span style="text-decoration: underline;">042</span>4  0.000<span style="text-decoration: underline;">032</span>2   0.000<span style="text-decoration: underline;">014</span>1  0.000<span style="text-decoration: underline;">004</span>01 0.000<span style="text-decoration: underline;">765</span>  0.000<span style="text-decoration: underline;">082</span>1 9.40<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    20 0.000<span style="text-decoration: underline;">060</span>0  0.000<span style="text-decoration: underline;">051</span>1   0.000<span style="text-decoration: underline;">015</span>8  0.000<span style="text-decoration: underline;">009</span>28 0.001<span style="text-decoration: underline;">14</span>   0.000<span style="text-decoration: underline;">130</span>  1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: cnt &lt;chr&gt;</span></span></span></code></pre></div>
<p>For <code>mdecomp</code> 2 lists with arrays for 2 population are
required.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#US men</span></span>
<span><span class="va">mx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>all <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">all</span>, </span>
<span>            neoplasm <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">neoplasms</span>, </span>
<span>            circulatory <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">circulatory</span>, </span>
<span>            respiratory <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">respiratory</span>,</span>
<span>            digestive <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">digestive</span>,</span>
<span>            accident <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">accident</span>,</span>
<span>            other <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"usa"</span>,<span class="op">]</span><span class="op">$</span><span class="va">other</span><span class="op">)</span></span>
<span><span class="co">#England and Wales men</span></span>
<span><span class="va">mx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>all <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">all</span>, </span>
<span>            neoplasm <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">neoplasms</span>, </span>
<span>            circulatory <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">circulatory</span>, </span>
<span>            respiratory <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">respiratory</span>,</span>
<span>            digestive <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">digestive</span>,</span>
<span>            accident <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">accident</span>,</span>
<span>            other <span class="op">=</span> <span class="va">mdecompex</span><span class="op">[</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">cnt</span><span class="op">==</span><span class="st">"eng"</span>,<span class="op">]</span><span class="op">$</span><span class="va">other</span><span class="op">)</span></span>
<span></span>
<span><span class="va">decm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdecomp.html">mdecomp</a></span><span class="op">(</span>mx1 <span class="op">=</span> <span class="va">mx1</span>, </span>
<span>              mx2 <span class="op">=</span> <span class="va">mx2</span>, </span>
<span>              sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>              age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mdecompex</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age ex12      neoplasm  circulatory   respiratory     digestive   accident</span></span>
<span><span class="co">#&gt; 1   0 0.12  0.0008745885 6.544742e-03  0.0038965543  6.616401e-03 0.02107294</span></span>
<span><span class="co">#&gt; 2   1 0.03 -0.0025030458 5.483996e-04  0.0020247182  6.245908e-04 0.03637029</span></span>
<span><span class="co">#&gt; 3   5 0.02 -0.0016468368 8.262058e-05 -0.0001300012  9.929857e-05 0.02178479</span></span>
<span><span class="co">#&gt; 4  10 0.01 -0.0014084238 4.993427e-04 -0.0002451017  8.338450e-05 0.01117647</span></span>
<span><span class="co">#&gt; 5  15 0.13 -0.0032690840 2.657675e-03  0.0005053688 -2.052103e-04 0.13796276</span></span>
<span><span class="co">#&gt; 6  20 0.17 -0.0009648903 2.773336e-03 -0.0016773417 -8.983808e-04 0.18353643</span></span>
<span><span class="co">#&gt;           other</span></span>
<span><span class="co">#&gt; 1  0.0809947781</span></span>
<span><span class="co">#&gt; 2 -0.0070649563</span></span>
<span><span class="co">#&gt; 3 -0.0001898743</span></span>
<span><span class="co">#&gt; 4 -0.0001056675</span></span>
<span><span class="co">#&gt; 5 -0.0076515085</span></span>
<span><span class="co">#&gt; 6 -0.0127691565</span></span></code></pre></div>
<p>Than let us plot the result of <code>mdecomp</code> using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a>. This requires
some data transformations</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">decm_plot</span> <span class="op">&lt;-</span> <span class="va">decm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"ex12"</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">decm_plot_i</span> <span class="op">&lt;-</span> <span class="va">decm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">i</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">decm_plot_i</span><span class="op">$</span><span class="va">group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">decm_plot_i</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"ex12"</span></span>
<span>  <span class="va">decm_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">decm_plot</span>,<span class="va">decm_plot_i</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">decm_plot_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">decm_plot</span><span class="op">[</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">decm_plot</span><span class="op">[</span><span class="va">decm_plot</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span><span class="op">$</span><span class="va">ex12</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">decm_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">ex12</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Set1"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"Contribution to difference in ex"</span>, fill <span class="op">=</span> <span class="st">"Cause (contribution):"</span>, </span>
<span>       caption  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Total difference in ex = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">decm</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="associated-single-decrement-life-table">Associated single decrement life table<a class="anchor" aria-label="anchor" href="#associated-single-decrement-life-table"></a>
</h3>
<p>There is <code><a href="../reference/asdt.html">asdt()</a></code> function that calculates <em>associated
single decrement life table</em> (ASDT) for causes of death
(<em>cause-deleted life table</em>). In other words, by this function
one can answer the question “what will be the life expectancy if there
is no mortality from cause i?”<br>
For example in the <code>demor</code> data (as it is easy to guess,
taken from Andreev &amp; Shkolnikov <a href="https://www.demogr.mpg.de/en/publications_databases_6118/publications_1904/mpidr_technical_reports/an_excel_spreadsheet_for_the_decomposition_of_a_difference_between_two_values_of_an_aggregate_demographic_4591" class="external-link">spreadsheet</a>)
on mortality of US men in 2002 by some causes is added. Let me show what
would be <span class="math inline">\(e_x\)</span> if there is no deaths
from neoplasm (i)</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"asdtex"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">asdt_neoplasm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/asdt.html">asdt</a></span><span class="op">(</span>age <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">age</span>, </span>
<span>                      sex <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                      m_all <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">all</span>, </span>
<span>                      m_i <span class="op">=</span> <span class="va">asdtex</span><span class="op">$</span><span class="va">neoplasms</span>, </span>
<span>                      full <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                      method <span class="op">=</span> <span class="st">"chiang1968"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">asdt_neoplasm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"ex"</span>, <span class="st">"ex_without_i"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   age    ex ex_without_i</span></span>
<span><span class="co">#&gt; 1   0 74.65        78.58</span></span>
<span><span class="co">#&gt; 2   1 74.22        78.18</span></span>
<span><span class="co">#&gt; 3   5 70.32        74.28</span></span>
<span><span class="co">#&gt; 4  10 65.38        69.33</span></span>
<span><span class="co">#&gt; 5  15 60.45        64.39</span></span>
<span><span class="co">#&gt; 6  20 55.72        59.67</span></span></code></pre></div>
<p>One can plot the results using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">asdt_neoplasm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ex</span>, color <span class="op">=</span> <span class="st">"ex"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ex_without_i</span>, color <span class="op">=</span> <span class="st">"ex without neoplasms"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-16-1.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">asdt_neoplasm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lx</span>, color <span class="op">=</span> <span class="st">"ex"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">l_not_i</span>, color <span class="op">=</span> <span class="st">"ex without neoplasms"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-16-2.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="mortality-models-for-mx-approximation">Mortality models for mx approximation<a class="anchor" aria-label="anchor" href="#mortality-models-for-mx-approximation"></a>
</h3>
<p>In <code>demor</code> there is a function <code>mort.approx</code>
for modeling mx. Now “Gompertz” and “Brass” are supported (see Preston,
Heuveline &amp; Guillot, 2001 for more details on the functions).</p>
<p>Function returns list with estimated model (parameters, R-squred,
variance-covariance matrix of parameters) and dataframe with predicted
mx.</p>
<p>The example below shows the model that try to approximate mx of
russian men in 2010 using Brass function and rissian mortality of 2000
as standard mortality.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="va">rus2000</span> <span class="op">&lt;-</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2000</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">brass_2010</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mort.approx.html">mort.approx</a></span><span class="op">(</span>mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span>,</span>
<span>                          age <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">age</span>,</span>
<span>                          model <span class="op">=</span> <span class="st">"Brass"</span>,</span>
<span>                          standard.mx <span class="op">=</span> <span class="va">rus2000</span><span class="op">$</span><span class="va">mx</span>,</span>
<span>                          boot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">brass_2010</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "Brass"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt;           a           b </span></span>
<span><span class="co">#&gt; -0.06074055  1.07357088 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $covmat</span></span>
<span><span class="co">#&gt;              a            b</span></span>
<span><span class="co">#&gt; a 0.0011738655 0.0005893843</span></span>
<span><span class="co">#&gt; b 0.0005893843 0.0004137586</span></span></code></pre></div>
<p>Lets plot the modeled and observed mx with bootstrapped 95% CI.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brass_2010</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mx <span class="op">=</span> <span class="va">rus2010</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mx</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mx.pred</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">low_2.5prc</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">high_97.5prc</span><span class="op">)</span><span class="op">)</span>, </span>
<span>              alpha <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"red"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, y <span class="op">=</span> <span class="st">"ln mx"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="fertility">Fertility<a class="anchor" aria-label="anchor" href="#fertility"></a>
</h2>
<p>For the analysis of fertility in the <code>demor</code> there are
only a few functions, due to the author’s preference for mortality
analysis…</p>
<div class="section level3">
<h3 id="get-fertility-data">Get fertility data<a class="anchor" aria-label="anchor" href="#get-fertility-data"></a>
</h3>
<p><strong>DEPRECATED</strong></p>
<p>Lets get basic <em>fertility data</em> (asFR or <span class="math inline">\(f_x\)</span>) from <a href="http://demogr.nes.ru/index.php/ru/demogr_indicat/data" class="external-link">RosBris</a>
using <code><a href="../reference/get_rosbris.html">get_rosbris()</a></code></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dbf &lt;- get_rosbris(</span></span>
<span><span class="co">#   #fertility data</span></span>
<span><span class="co">#   type = "f",</span></span>
<span><span class="co">#   #what age group download</span></span>
<span><span class="co">#   age =  1,</span></span>
<span><span class="co">#   #to get "long" data</span></span>
<span><span class="co">#   initial = F,</span></span>
<span><span class="co">#   #last available year</span></span>
<span><span class="co">#   lastyear = 2022</span></span>
<span><span class="co"># )</span></span></code></pre></div>
<p>Recently RosBris has been switched to new website, so the function
<code>get_rosbris</code> does not work now. I hope in a several months
all mistakes due to new website will be fixed and function will
work.</p>
<p>Now RosBris data is presented in the <code>demor</code> as datasets
in the long-format. The example of usage that replicates the data from
the previous chunk with <code>get_rosbris</code>:</p>
<p>Also not that there is data only for 1-year age intervals now due to
mistakes on the new RosBris website…</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbf</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_fertility_pop_1.html">rosbris_fertility_pop_1</a></span></span></code></pre></div>
<p>For the example Russia-2010 is gotten</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rus2010f</span> <span class="op">&lt;-</span> <span class="va">dbf</span><span class="op">[</span><span class="va">dbf</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbf</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span>,<span class="op">]</span></span>
<span><span class="va">rus2010f</span></span>
<span><span class="co">#&gt;       year code territory age       fx       N        Bx                 name</span></span>
<span><span class="co">#&gt; 16155 2010 1100         t  15 0.002828  718636   2032.30 Российская Федерация</span></span>
<span><span class="co">#&gt; 16156 2010 1100         t  16 0.007868  738942   5814.00 Российская Федерация</span></span>
<span><span class="co">#&gt; 16157 2010 1100         t  17 0.019538  806058  15748.76 Российская Федерация</span></span>
<span><span class="co">#&gt; 16158 2010 1100         t  18 0.036598  915096  33490.68 Российская Федерация</span></span>
<span><span class="co">#&gt; 16159 2010 1100         t  19 0.054816 1035519  56763.01 Российская Федерация</span></span>
<span><span class="co">#&gt; 16160 2010 1100         t  20 0.068020 1128146  76736.49 Российская Федерация</span></span>
<span><span class="co">#&gt; 16161 2010 1100         t  21 0.079420 1171368  93030.05 Российская Федерация</span></span>
<span><span class="co">#&gt; 16162 2010 1100         t  22 0.088931 1227186 109134.88 Российская Федерация</span></span>
<span><span class="co">#&gt; 16163 2010 1100         t  23 0.097337 1253198 121982.53 Российская Федерация</span></span>
<span><span class="co">#&gt; 16164 2010 1100         t  24 0.101037 1247182 126011.53 Российская Федерация</span></span>
<span><span class="co">#&gt; 16165 2010 1100         t  25 0.103926 1229049 127730.15 Российская Федерация</span></span>
<span><span class="co">#&gt; 16166 2010 1100         t  26 0.105334 1225430 129079.44 Российская Федерация</span></span>
<span><span class="co">#&gt; 16167 2010 1100         t  27 0.102049 1205347 123004.46 Российская Федерация</span></span>
<span><span class="co">#&gt; 16168 2010 1100         t  28 0.096021 1144048 109852.63 Российская Федерация</span></span>
<span><span class="co">#&gt; 16169 2010 1100         t  29 0.087114 1154109 100539.05 Российская Федерация</span></span>
<span><span class="co">#&gt; 16170 2010 1100         t  30 0.081186 1147757  93181.80 Российская Федерация</span></span>
<span><span class="co">#&gt; 16171 2010 1100         t  31 0.076022 1103356  83879.33 Российская Федерация</span></span>
<span><span class="co">#&gt; 16172 2010 1100         t  32 0.067751 1089992  73848.05 Российская Федерация</span></span>
<span><span class="co">#&gt; 16173 2010 1100         t  33 0.059360 1080930  64164.00 Российская Федерация</span></span>
<span><span class="co">#&gt; 16174 2010 1100         t  34 0.051026 1093922  55818.46 Российская Федерация</span></span>
<span><span class="co">#&gt; 16175 2010 1100         t  35 0.043833 1080620  47366.82 Российская Федерация</span></span>
<span><span class="co">#&gt; 16176 2010 1100         t  36 0.037177 1043520  38794.94 Российская Федерация</span></span>
<span><span class="co">#&gt; 16177 2010 1100         t  37 0.028480 1033189  29425.22 Российская Федерация</span></span>
<span><span class="co">#&gt; 16178 2010 1100         t  38 0.022616 1016060  22979.21 Российская Федерация</span></span>
<span><span class="co">#&gt; 16179 2010 1100         t  39 0.016427 1014281  16661.59 Российская Федерация</span></span>
<span><span class="co">#&gt; 16180 2010 1100         t  40 0.011828  985504  11656.54 Российская Федерация</span></span>
<span><span class="co">#&gt; 16181 2010 1100         t  41 0.008071  933120   7531.21 Российская Федерация</span></span>
<span><span class="co">#&gt; 16182 2010 1100         t  42 0.005070  923786   4683.60 Российская Федерация</span></span>
<span><span class="co">#&gt; 16183 2010 1100         t  43 0.002934  937586   2750.88 Российская Федерация</span></span>
<span><span class="co">#&gt; 16184 2010 1100         t  44 0.001530  984033   1505.57 Российская Федерация</span></span>
<span><span class="co">#&gt; 16185 2010 1100         t  45 0.000698 1027529    717.22 Российская Федерация</span></span>
<span><span class="co">#&gt; 16186 2010 1100         t  46 0.000345 1080939    372.92 Российская Федерация</span></span>
<span><span class="co">#&gt; 16187 2010 1100         t  47 0.000189 1147414    216.86 Российская Федерация</span></span>
<span><span class="co">#&gt; 16188 2010 1100         t  48 0.000080 1203214     96.26 Российская Федерация</span></span>
<span><span class="co">#&gt; 16189 2010 1100         t  49 0.000058 1279641     74.22 Российская Федерация</span></span>
<span><span class="co">#&gt; 16190 2010 1100         t  50 0.000022 1290011     28.38 Российская Федерация</span></span>
<span><span class="co">#&gt; 16191 2010 1100         t  51 0.000011 1254347     13.80 Российская Федерация</span></span>
<span><span class="co">#&gt; 16192 2010 1100         t  52 0.000016 1242620     19.88 Российская Федерация</span></span>
<span><span class="co">#&gt; 16193 2010 1100         t  53 0.000007 1212329      8.49 Российская Федерация</span></span>
<span><span class="co">#&gt; 16194 2010 1100         t  54 0.000006 1204291      7.23 Российская Федерация</span></span>
<span><span class="co">#&gt; 16195 2010 1100         t  55 0.000008 1213611      9.71 Российская Федерация</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tfr">TFR<a class="anchor" aria-label="anchor" href="#tfr"></a>
</h3>
<p>Now one can compute total fertility age (<em>TFR</em>) - the most
popular measure of fertility - that is standardized measure of “the
average number of children a woman would bear if she survived through
the end of the reproductive age span and experienced at each age a
particular set of age-specific fertility ages” <a href="https://gwern.net/doc/statistics/2001-preston-demography.pdf" class="external-link">Preston
et al, 2001, p. 95</a>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tfr.html">tfr</a></span><span class="op">(</span></span>
<span>  <span class="co">#asFR</span></span>
<span>  <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>,</span>
<span>  <span class="co">#age interval</span></span>
<span>  age.int <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.565588</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mac">MAC<a class="anchor" aria-label="anchor" href="#mac"></a>
</h3>
<p>MAC is a mean age at childbearing. One can compute it using <span class="math inline">\(f_x\)</span></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mac.html">mac</a></span><span class="op">(</span></span>
<span>  <span class="co">#asFR</span></span>
<span>  <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>,</span>
<span>  <span class="co">#array with ages</span></span>
<span>  ages <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [1] 27.65494</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fertility-models-for-asfr-approximation">Fertility models for ASFR approximation<a class="anchor" aria-label="anchor" href="#fertility-models-for-asfr-approximation"></a>
</h3>
<p>In <code>demor</code> there is a function <code>fert.approx</code>
for modeling ASFR. Now “Hadwiger”, “Gamma” and “Brass” are supported
(see Peristera &amp; Kostaki, 2007 for more details on the
functions).</p>
<p>Hadwiger model (optimal choice with balance of simplicity and
accuracy) is as follows: <span class="math display">\[f(age) =
\frac{ab}{c} \frac{c}{age}^{3/2}
exp[-b^2(\frac{c}{age}+\frac{age}{c}-2)]\]</span></p>
<p>Gamma model (sophisticated and accurate, but not really sustainable
due to convergence issues) is as follows: <span class="math display">\[f(age) = \frac{R}{\Gamma(b)c^b}(age-d)^{b-1}
exp[-(\frac{age-d}{c})]\]</span></p>
<p>Brass model (the simplest and the most inaccurate) is as follows:
<span class="math display">\[f(age) = c(age-d)(d+w-age)\]</span></p>
<p>Function returns list with estimated model (parameters, R-squred,
variance-covariance matrix of parameters) and dataframe with predicted
ASFR.</p>
<p>The example below shows the model that try to approximate ASFR of
russian women in 2010 using Gamma function.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">approximation_2010</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Gamma"</span>, boot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">approximation_2010</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $type</span></span>
<span><span class="co">#&gt; [1] "Gamma"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt;        R        b        c        d </span></span>
<span><span class="co">#&gt; 1.603204 8.512910 2.161928 9.048034 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Rsq</span></span>
<span><span class="co">#&gt; [1] 0.9954142</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $covmat</span></span>
<span><span class="co">#&gt;               R            b             c             d</span></span>
<span><span class="co">#&gt; R  0.0002956914 -0.002461275  0.0006176426  0.0006317489</span></span>
<span><span class="co">#&gt; b -0.0024612750  1.668815802 -0.2388863457 -1.6943450227</span></span>
<span><span class="co">#&gt; c  0.0006176426 -0.238886346  0.0349105043  0.2375133186</span></span>
<span><span class="co">#&gt; d  0.0006317489 -1.694345023  0.2375133186  1.7605961160</span></span></code></pre></div>
<p>Lets plot the modeled and observed ASFR with bootstrapped 95% CI. One
can see that model perfectly approximates real ASFR from 15 to 40 ages,
while after the fit is not really good. Meanwhile, the model explains
99.7% of variance in observed ASFR.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="va">approximation_2010</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">predicted</span>, color <span class="op">=</span> <span class="st">"fx from Gamma model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">low_2.5prc</span>, ymax <span class="op">=</span> <span class="va">high_97.5prc</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>real <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">real</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-25-1.png" width="100%"></p>
<p>Lets now do the same procedure but with Hadwiger function:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Hadwiger"</span>, boot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">predicted</span>, color <span class="op">=</span> <span class="st">"fx from Hadwiger model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">low_2.5prc</span>, ymax <span class="op">=</span> <span class="va">high_97.5prc</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>real <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">real</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-26-1.png" width="100%"></p>
<p>Lets now do the same procedure but with Brass function:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="../reference/fert.approx.html">fert.approx</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span>, model <span class="op">=</span> <span class="st">"Brass"</span>, boot <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">predicted</span>, color <span class="op">=</span> <span class="st">"fx from Brass model"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">low_2.5prc</span>, ymax <span class="op">=</span> <span class="va">high_97.5prc</span>, x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>real <span class="op">=</span> <span class="va">rus2010f</span><span class="op">$</span><span class="va">fx</span>, age <span class="op">=</span> <span class="fl">15</span><span class="op">:</span><span class="fl">55</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, y <span class="op">=</span> <span class="va">real</span>, color <span class="op">=</span> <span class="st">"Observed fx"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"fx"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-27-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="projections">Projections<a class="anchor" aria-label="anchor" href="#projections"></a>
</h2>
<div class="section level3">
<h3 id="lee-carter-model">Lee-Carter model<a class="anchor" aria-label="anchor" href="#lee-carter-model"></a>
</h3>
<p>In the <code>demor</code> there is <code><a href="../reference/leecart.html">leecart()</a></code> function
that provides users with basic <em>Lee-Carter model</em> (proposed by
Lee and Carter in 1992 and that now has a lot of extensions) for
mortality forecasting:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dbm.1</span> <span class="op">&lt;-</span> <span class="fu">demor</span><span class="fu">::</span><span class="va"><a href="../reference/rosbris_mortality_pop_1.html">rosbris_mortality_pop_1</a></span></span>
<span></span>
<span><span class="va">leecart_forecast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leecart.html">leecart</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> </span>
<span>                                           <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2004</span><span class="op">:</span><span class="fl">2019</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"age"</span>, <span class="st">"mx"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                            n <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                            sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>                            concise <span class="op">=</span> <span class="cn">T</span></span>
<span>                            <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">leecart_forecast</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year age           mx     mx_low95    mx_high95    ex ex_low95 ex_high95</span></span>
<span><span class="co">#&gt; 1 2020   0 0.0051383321 0.0048555214 0.0054376152 69.44    68.86     70.03</span></span>
<span><span class="co">#&gt; 2 2020   1 0.0004663746 0.0004393745 0.0004950340 68.80    68.24     69.37</span></span>
<span><span class="co">#&gt; 3 2020   2 0.0002934932 0.0002756235 0.0003125214 67.83    67.27     68.40</span></span>
<span><span class="co">#&gt; 4 2020   3 0.0002396593 0.0002248883 0.0002554005 66.85    66.29     67.42</span></span>
<span><span class="co">#&gt; 5 2020   4 0.0002001969 0.0001869453 0.0002143880 65.87    65.31     66.43</span></span>
<span><span class="co">#&gt; 6 2020   5 0.0001918685 0.0001805702 0.0002038738 64.88    64.32     65.44</span></span></code></pre></div>
<p>One can plot the results using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a> to comapare
predicted data with actual that, however, requires some data
handling:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#LE data calculation</span></span>
<span><span class="va">ledata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2022</span>, lem <span class="op">=</span> <span class="cn">NA</span>, lem.predicted <span class="op">=</span> <span class="cn">NA</span>, ci.low <span class="op">=</span> <span class="cn">NA</span>, ci.high <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2022</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ledata</span><span class="op">[</span><span class="va">ledata</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LT.html">LT</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dbm</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>                                 sex <span class="op">=</span> <span class="st">"m"</span>, </span>
<span>                                 mx <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span> <span class="op">&amp;</span> </span>
<span>                                            <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span> <span class="op">&amp;</span> </span>
<span>                                            <span class="va">dbm</span><span class="op">$</span><span class="va">code</span> <span class="op">==</span> <span class="fl">1100</span> <span class="op">&amp;</span> </span>
<span>                                            <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"ex"</span><span class="op">]</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">&gt;=</span><span class="fl">2019</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">2019</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">ledata</span><span class="op">[</span><span class="va">ledata</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">ledata</span><span class="op">[</span><span class="va">ledata</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="va">ledata</span><span class="op">[</span><span class="va">ledata</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="va">i</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">leecart_forecast</span><span class="op">[</span><span class="va">leecart_forecast</span><span class="op">$</span><span class="va">age</span><span class="op">==</span><span class="st">"0"</span> <span class="op">&amp;</span> </span>
<span>                                                     <span class="va">leecart_forecast</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="va">i</span>,<span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ledata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lem</span>, color <span class="op">=</span> <span class="st">"Observed data"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lem</span>, color <span class="op">=</span> <span class="st">"Observed data"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lem.predicted</span>, color <span class="op">=</span> <span class="st">"Predicted data"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lem.predicted</span>, color <span class="op">=</span> <span class="st">"Predicted data"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">ci.low</span>, ymax <span class="op">=</span> <span class="va">ci.high</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"pink"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2019</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkgrey"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2022</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">63</span><span class="op">:</span><span class="fl">70</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"darkred"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Male's LE at birth"</span>, colour <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-29-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="leslie-matrix">Leslie matrix<a class="anchor" aria-label="anchor" href="#leslie-matrix"></a>
</h3>
<p>In beta now.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">les.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leslie.html">leslie</a></span><span class="op">(</span>mx <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> </span>
<span>                                <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> </span>
<span>                                <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span> <span class="op">&amp;</span> </span>
<span>                                <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2019</span>,<span class="op">]</span><span class="op">$</span><span class="va">mx</span>, </span>
<span>                     fx <span class="op">=</span> <span class="va">dbf</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> </span>
<span>                                <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> </span>
<span>                                <span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2019</span>,<span class="op">]</span><span class="op">$</span><span class="va">fx</span>, </span>
<span>                     age1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>                     age2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dbf</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, </span>
<span>                     sex <span class="op">=</span> <span class="st">"m"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">les.matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4] [,5]</span></span>
<span><span class="co">#&gt; [1,] 0.0000000 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [2,] 0.9990357 0.0000000 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.9995978 0.0000000 0.0000000    0</span></span>
<span><span class="co">#&gt; [4,] 0.0000000 0.0000000 0.9997284 0.0000000    0</span></span>
<span><span class="co">#&gt; [5,] 0.0000000 0.0000000 0.0000000 0.9997585    0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cohort-component-model">Cohort-component model<a class="anchor" aria-label="anchor" href="#cohort-component-model"></a>
</h3>
<p>Soon</p>
</div>
<div class="section level3">
<h3 id="probabilistic-model">Probabilistic model<a class="anchor" aria-label="anchor" href="#probabilistic-model"></a>
</h3>
<p>Soon, now beta version is done.</p>
<p>Data handling for the model.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mort.m</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Российская Федерация"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"m"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">year</span>,<span class="va">age</span>, <span class="va">mx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mort.f</span> <span class="op">&lt;-</span> <span class="va">dbm.1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Российская Федерация"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">year</span>,<span class="va">age</span>, <span class="va">mx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fert</span> <span class="op">&lt;-</span> <span class="va">dbf</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Российская Федерация"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">year</span>, <span class="va">age</span>, <span class="va">fx</span><span class="op">)</span></span>
<span></span>
<span><span class="va">popm</span> <span class="op">=</span> <span class="va">dbm.1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Российская Федерация"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"m"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">year</span>,<span class="va">age</span>, pop <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span>
<span></span>
<span><span class="va">popf</span> <span class="op">=</span> <span class="va">dbm.1</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">territory</span> <span class="op">==</span> <span class="st">"t"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Российская Федерация"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">year</span>,<span class="va">age</span>, pop <span class="op">=</span> <span class="va">N</span><span class="op">)</span></span></code></pre></div>
<p>The model:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prob.proj.html">prob.proj</a></span><span class="op">(</span><span class="va">mort.m</span>, <span class="va">mort.f</span>, <span class="va">fert</span>, </span>
<span>                 time.n <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                 sims <span class="op">=</span> <span class="fl">250</span>, <span class="co">#set low number for an example </span></span>
<span>                 <span class="va">popf</span>, <span class="va">popm</span><span class="op">)</span></span></code></pre></div>
<p>Population projection:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025popf`</span> <span class="op">+</span> <span class="va">`0.025popm`</span>, ymax <span class="op">=</span> <span class="va">`0.925popf`</span> <span class="op">+</span> <span class="va">`0.925popm`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125popf`</span> <span class="op">+</span> <span class="va">`0.125popm`</span>, ymax <span class="op">=</span> <span class="va">`0.825popf`</span> <span class="op">+</span> <span class="va">`0.825popm`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225popf`</span> <span class="op">+</span> <span class="va">`0.225popm`</span>, ymax <span class="op">=</span> <span class="va">`0.725popf`</span> <span class="op">+</span> <span class="va">`0.725popm`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425popf`</span> <span class="op">+</span> <span class="va">`0.425popm`</span>, ymax <span class="op">=</span> <span class="va">`0.625popf`</span> <span class="op">+</span> <span class="va">`0.625popm`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5popf`</span> <span class="op">+</span> <span class="va">`0.5popm`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/unit_format.html" class="external-link">unit_format</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">"k"</span>, scale <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Population"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-33-1.png" width="100%"></p>
<p>Net population growth:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025net`</span>, ymax <span class="op">=</span> <span class="va">`0.925net`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125net`</span>, ymax <span class="op">=</span> <span class="va">`0.825net`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225net`</span>, ymax <span class="op">=</span> <span class="va">`0.725net`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425net`</span>, ymax <span class="op">=</span> <span class="va">`0.625net`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5net`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/unit_format.html" class="external-link">unit_format</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="st">"k"</span>, scale <span class="op">=</span> <span class="fl">1e-3</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Net population growth"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-34-1.png" width="100%"></p>
<p>TFR projection:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025tfr`</span>, ymax <span class="op">=</span> <span class="va">`0.925tfr`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125tfr`</span>, ymax <span class="op">=</span> <span class="va">`0.825tfr`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225tfr`</span>, ymax <span class="op">=</span> <span class="va">`0.725tfr`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425tfr`</span>, ymax <span class="op">=</span> <span class="va">`0.625tfr`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5tfr`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"TFR"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-35-1.png" width="100%"></p>
<p>Life expectancy at birth projections:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">e0m.proj</span> <span class="op">&lt;-</span> <span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025e0m`</span>, ymax <span class="op">=</span> <span class="va">`0.925e0m`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125e0m`</span>, ymax <span class="op">=</span> <span class="va">`0.825e0m`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225e0m`</span>, ymax <span class="op">=</span> <span class="va">`0.725e0m`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425e0m`</span>, ymax <span class="op">=</span> <span class="va">`0.625e0m`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5e0m`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Life Expectancy at 0 (males)"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">e0f.proj</span> <span class="op">&lt;-</span> <span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025e0f`</span>, ymax <span class="op">=</span> <span class="va">`0.925e0f`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125e0f`</span>, ymax <span class="op">=</span> <span class="va">`0.825e0f`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225e0f`</span>, ymax <span class="op">=</span> <span class="va">`0.725e0f`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425e0f`</span>, ymax <span class="op">=</span> <span class="va">`0.625e0f`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5e0f`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Life Expectancy at 0 (females)"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">e0m.proj</span>;<span class="va">e0f.proj</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-36-1.png" width="100%"><img src="demor_files/figure-html/unnamed-chunk-36-2.png" width="100%"></p>
<p>Median age:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025med.age`</span>, ymax <span class="op">=</span> <span class="va">`0.925med.age`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125med.age`</span>, ymax <span class="op">=</span> <span class="va">`0.825med.age`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225med.age`</span>, ymax <span class="op">=</span> <span class="va">`0.725med.age`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425med.age`</span>, ymax <span class="op">=</span> <span class="va">`0.625med.age`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5med.age`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Median age"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-37-1.png" width="100%"></p>
<p>Dependency ratios:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dep.old</span> <span class="op">&lt;-</span> <span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025old.dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.925old.dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125old.dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.825old.dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225old.dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.725old.dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425old.dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.625old.dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5old.dependency`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Old-age (65+) dependency ratio"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dep.all</span> <span class="op">&lt;-</span> <span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_linedraw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.025dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.925dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.125dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.825dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.225dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.725dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">`0.425dependency`</span>, ymax <span class="op">=</span> <span class="va">`0.625dependency`</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">`0.5dependency`</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Dependency (&lt;=20, 65+) Ratio"</span>, x <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ex1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">year</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dep.old</span>; <span class="va">dep.all</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-38-1.png" width="100%"><img src="demor_files/figure-html/unnamed-chunk-38-2.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h2>
<div class="section level3">
<h3 id="population-pyramid">Population pyramid<a class="anchor" aria-label="anchor" href="#population-pyramid"></a>
</h3>
<p><code>plot_pyr</code> plots population pyramid using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a><br>
Lets create population pyramid using midyear population from Rosbris
mortality data. We already have data in <code>dbm</code>.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_pyr.html">plot_pyr</a></span><span class="op">(</span></span>
<span>  popm <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popf <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>, </span>
<span>  ages <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-39-1.png" width="100%"></p>
<p>Also one can redesigned plot using <a href="https://github.com/tidyverse/ggplot2" class="external-link">ggplot2</a> functions:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/plot_pyr.html">plot_pyr</a></span><span class="op">(</span></span>
<span>  popm <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>  popf <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>, </span>
<span>  ages <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"f"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"My y"</span>, x <span class="op">=</span> <span class="st">"Age"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="demor_files/figure-html/unnamed-chunk-40-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="median-age">Median age<a class="anchor" aria-label="anchor" href="#median-age"></a>
</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Using 1-year age interval</span></span>
<span><span class="fu"><a href="../reference/med.age.html">med.age</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>        age <span class="op">=</span> <span class="va">dbm.1</span><span class="op">[</span><span class="va">dbm.1</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm.1</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span>,</span>
<span>        int <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.96885</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Using 5-year age interval</span></span>
<span><span class="fu"><a href="../reference/med.age.html">med.age</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">N</span>,</span>
<span>        age <span class="op">=</span> <span class="va">dbm</span><span class="op">[</span><span class="va">dbm</span><span class="op">$</span><span class="va">year</span><span class="op">==</span><span class="fl">2010</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">code</span><span class="op">==</span><span class="fl">1100</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">territory</span><span class="op">==</span><span class="st">"t"</span> <span class="op">&amp;</span> <span class="va">dbm</span><span class="op">$</span><span class="va">sex</span><span class="op">==</span><span class="st">"m"</span>,<span class="op">]</span><span class="op">$</span><span class="va">age</span>,</span>
<span>        int <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 34.99351</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="recoding-age">Recoding age<a class="anchor" aria-label="anchor" href="#recoding-age"></a>
</h3>
<p><code>ages</code> converts continuous ages to age groups. For
example, array with <span class="math inline">\(\{ 0,1,2,3...100
\}\)</span> it can convert to <span class="math inline">\(\{&lt;5,6-9,10-14 ... 85+ \}\)</span> using
user-specific lower boundaries.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">45</span>, <span class="fl">85</span><span class="op">)</span> <span class="co">#lower boundaries of age groups</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">101</span><span class="op">)</span> <span class="co">#simulated array with ages</span></span>
<span></span>
<span><span class="va">new.age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ages.html">ages</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, groups <span class="op">=</span> <span class="va">groups</span>, char <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">new.age</span><span class="op">)</span> <span class="co">#see new groups with the number of values in the group </span></span>
<span><span class="co">#&gt; new.age</span></span>
<span><span class="co">#&gt;     0   1-4   5-9 10-19 20-44 45-84   85+ </span></span>
<span><span class="co">#&gt;     1     4     5    10    25    40    16</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Center for Demographic Research (2023). <em>Russian Fertility and
Mortality Database (Rosbris)</em>. <a href="http://www.demogr.nes.ru/en/demogr_indicat/data" class="external-link">URL</a><br>
</li>
<li>Preston, S. H., Heuveline, P., &amp; Guillot, M. (2001). Demography:
Measuring and modeling population processes. Blackwell Publishers. (<a href="https://gwern.net/doc/statistics/2001-preston-demography.pdf" class="external-link">pdf</a>)<br>
</li>
<li>Andreev, E. M., &amp; Kingkade, W. W. (2015). Average age at death
in infancy and infant mortality level: Reconsidering the Coale-Demeny
formulas at current levels of low mortality. <em>Demographic
Research</em>, <em>33</em>, 363-390.<br>
</li>
<li>Ghislandi, S., Sanderson, W. C., &amp; Scherbov, S. (2019). A simple
measure of human development: The human life indicator. <em>Population
and development review</em>, <em>45</em>(<em>1</em>), 219-233.<br>
</li>
<li>Andreev, E. M., &amp; Shkolnikov, V. M. (2012). <em>An Excel
spreadsheet for the decomposition of a difference between two values of
an aggregate demographic measure by stepwise replacement running from
young to old ages</em>. MPIDR Technical Report TR-2012-002. <a href="https://www.demogr.mpg.de/en/publications_databases_6118/publications_1904/mpidr_technical_reports/an_excel_spreadsheet_for_the_decomposition_of_a_difference_between_two_values_of_an_aggregate_demographic_4591" class="external-link">URL</a><br>
</li>
<li>Lee, R. D., &amp; Carter, L. R. (1992). Modeling and forecasting US
mortality. <em>Journal of the American statistical association</em>,
<em>87</em>(<em>419</em>), 659-671.<br>
</li>
<li>Ghislandi, S., Sanderson, W.C., &amp; Scherbov, S. (2019). A Simple
Measure of Human Development: The Human Life Indicator. <em>Population
and Development Review</em>, <em>45</em>, 219–233.<br>
</li>
<li>Peristera, P., &amp; Kostaki, A. (2007). Modeling fertility in
modern populations. <em>Demographic Research</em>, <em>16</em>,
141-194.<br>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vadim Ustyuzhanin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
