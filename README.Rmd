---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE, 
  message = FALSE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# demor

<!-- badges: start -->
<!-- badges: end -->

The goal of `demor` is to provide you with:
* the most basic functions for demographic analysis    
* Some data

## Installation

You can install the development version of demor from [GitHub](https://github.com/) with:

``` r

# install.packages("devtools")
devtools::install_github("vadvu/demor")

```

## Get ROSBRIS data

For getting data from [RosBris](http://demogr.nes.ru/index.php/ru/demogr_indicat/data) there is function `get_rosbris()` that can download 
data on mortality/fertility by 1/5-year age groups from 1989 to the last available year (in 2023 its 2022).    
Worth noting: downloading and preparing the final file can get some time.    
In the chunk below mortality data for 5-age groups with population in "long" format is loading. For more function description use `?get_rosbris` 

```{r}
library(demor)

db <- get_rosbris(
  #mortality data
  type = "m",
  #what age group download
  age =  5,
  #to get "long" data
  initial = F,
  #last available year (the name of the downloading file contains years, so for the downloading the last year is required)
  lastyear = 2022
)
```

Lets see data for Russia in 2010 for males and for total population

```{r}
db[db$year==2010 & db$code==1100 & db$sex=="m" & db$territory=="t",]
```

Now one can create life-table based on getted data for 2010-Russia using `LT()`

```{r}
rus2010 <- db[db$year==2010 & db$code==1100 & db$sex=="m" & db$territory=="t",]

LT(
  age = rus2010$age, 
  sex = "m", 
  #age specific mortality rates
  mx = rus2010$mx)
```

Also one can do simple decomposition between 2 populations. Lets use Russia-2000 as base population and Russia-2010 as compared population

```{r}
rus2010 <- db[db$year==2010 & db$code==1100 & db$sex=="m" & db$territory=="t",]
rus2000 <- db[db$year==2000 & db$code==1100 & db$sex=="m" & db$territory=="t",]

dec <- decomp(mx1 = rus2000$mx, 
              mx2 = rus2010$mx, 
              sex = "m", 
              age = rus2000$age, 
              method = "andreev")
dec
```


```{r, echo=FALSE}
barplot(height=dec$ex12, 
        names=dec$age,
        xlab="Age-groups", 
        ylab="Ð¡ontribution to the e0 difference")
```






